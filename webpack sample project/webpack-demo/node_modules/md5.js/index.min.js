"use strict";var inherits=require("inherits");var HashBase=require("hash-base");var ARRAY16=new Array(16);function MD5(){HashBase.call(this,64);this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878}inherits(MD5,HashBase);MD5.prototype._update=function(){var k=ARRAY16;for(var g=0;g<16;++g){k[g]=this._block.readInt32LE(g*4)}var f=this._a;var e=this._b;var j=this._c;var h=this._d;f=fnF(f,e,j,h,k[0],3614090360,7);h=fnF(h,f,e,j,k[1],3905402710,12);j=fnF(j,h,f,e,k[2],606105819,17);e=fnF(e,j,h,f,k[3],3250441966,22);f=fnF(f,e,j,h,k[4],4118548399,7);h=fnF(h,f,e,j,k[5],1200080426,12);j=fnF(j,h,f,e,k[6],2821735955,17);e=fnF(e,j,h,f,k[7],4249261313,22);f=fnF(f,e,j,h,k[8],1770035416,7);h=fnF(h,f,e,j,k[9],2336552879,12);j=fnF(j,h,f,e,k[10],4294925233,17);e=fnF(e,j,h,f,k[11],2304563134,22);f=fnF(f,e,j,h,k[12],1804603682,7);h=fnF(h,f,e,j,k[13],4254626195,12);j=fnF(j,h,f,e,k[14],2792965006,17);e=fnF(e,j,h,f,k[15],1236535329,22);f=fnG(f,e,j,h,k[1],4129170786,5);h=fnG(h,f,e,j,k[6],3225465664,9);j=fnG(j,h,f,e,k[11],643717713,14);e=fnG(e,j,h,f,k[0],3921069994,20);f=fnG(f,e,j,h,k[5],3593408605,5);h=fnG(h,f,e,j,k[10],38016083,9);j=fnG(j,h,f,e,k[15],3634488961,14);e=fnG(e,j,h,f,k[4],3889429448,20);f=fnG(f,e,j,h,k[9],568446438,5);h=fnG(h,f,e,j,k[14],3275163606,9);j=fnG(j,h,f,e,k[3],4107603335,14);e=fnG(e,j,h,f,k[8],1163531501,20);f=fnG(f,e,j,h,k[13],2850285829,5);h=fnG(h,f,e,j,k[2],4243563512,9);j=fnG(j,h,f,e,k[7],1735328473,14);e=fnG(e,j,h,f,k[12],2368359562,20);f=fnH(f,e,j,h,k[5],4294588738,4);h=fnH(h,f,e,j,k[8],2272392833,11);j=fnH(j,h,f,e,k[11],1839030562,16);e=fnH(e,j,h,f,k[14],4259657740,23);f=fnH(f,e,j,h,k[1],2763975236,4);h=fnH(h,f,e,j,k[4],1272893353,11);j=fnH(j,h,f,e,k[7],4139469664,16);e=fnH(e,j,h,f,k[10],3200236656,23);f=fnH(f,e,j,h,k[13],681279174,4);h=fnH(h,f,e,j,k[0],3936430074,11);j=fnH(j,h,f,e,k[3],3572445317,16);e=fnH(e,j,h,f,k[6],76029189,23);f=fnH(f,e,j,h,k[9],3654602809,4);h=fnH(h,f,e,j,k[12],3873151461,11);j=fnH(j,h,f,e,k[15],530742520,16);e=fnH(e,j,h,f,k[2],3299628645,23);f=fnI(f,e,j,h,k[0],4096336452,6);h=fnI(h,f,e,j,k[7],1126891415,10);j=fnI(j,h,f,e,k[14],2878612391,15);e=fnI(e,j,h,f,k[5],4237533241,21);f=fnI(f,e,j,h,k[12],1700485571,6);h=fnI(h,f,e,j,k[3],2399980690,10);j=fnI(j,h,f,e,k[10],4293915773,15);e=fnI(e,j,h,f,k[1],2240044497,21);f=fnI(f,e,j,h,k[8],1873313359,6);h=fnI(h,f,e,j,k[15],4264355552,10);j=fnI(j,h,f,e,k[6],2734768916,15);e=fnI(e,j,h,f,k[13],1309151649,21);f=fnI(f,e,j,h,k[4],4149444226,6);h=fnI(h,f,e,j,k[11],3174756917,10);j=fnI(j,h,f,e,k[2],718787259,15);e=fnI(e,j,h,f,k[9],3951481745,21);this._a=(this._a+f)|0;this._b=(this._b+e)|0;this._c=(this._c+j)|0;this._d=(this._d+h)|0};MD5.prototype._digest=function(){this._block[this._blockOffset++]=128;if(this._blockOffset>56){this._block.fill(0,this._blockOffset,64);this._update();this._blockOffset=0}this._block.fill(0,this._blockOffset,56);this._block.writeUInt32LE(this._length[0],56);this._block.writeUInt32LE(this._length[1],60);this._update();var a=new Buffer(16);a.writeInt32LE(this._a,0);a.writeInt32LE(this._b,4);a.writeInt32LE(this._c,8);a.writeInt32LE(this._d,12);return a};function rotl(a,b){return(a<<b)|(a>>>(32-b))}function fnF(g,f,l,j,e,h,i){return(rotl((g+((f&l)|((~f)&j))+e+h)|0,i)+f)|0}function fnG(g,f,l,j,e,h,i){return(rotl((g+((f&j)|(l&(~j)))+e+h)|0,i)+f)|0}function fnH(g,f,l,j,e,h,i){return(rotl((g+(f^l^j)+e+h)|0,i)+f)|0}function fnI(g,f,l,j,e,h,i){return(rotl((g+((l^(f|(~j))))+e+h)|0,i)+f)|0}module.exports=MD5;