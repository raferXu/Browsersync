"use strict";var inherits=require("inherits");var Legacy=require("./legacy");var Base=require("cipher-base");var Buffer=require("safe-buffer").Buffer;var md5=require("create-hash/md5");var RIPEMD160=require("ripemd160");var sha=require("sha.js");var ZEROS=Buffer.alloc(128);function Hmac(g,c){Base.call(this,"digest");if(typeof c==="string"){c=Buffer.from(c)}var e=(g==="sha512"||g==="sha384")?128:64;this._alg=g;this._key=c;if(c.length>e){var f=g==="rmd160"?new RIPEMD160():sha(g);c=f.update(c).digest()}else{if(c.length<e){c=Buffer.concat([c,ZEROS],e)}}var a=this._ipad=Buffer.allocUnsafe(e);var d=this._opad=Buffer.allocUnsafe(e);for(var b=0;b<e;b++){a[b]=c[b]^54;d[b]=c[b]^92}this._hash=g==="rmd160"?new RIPEMD160():sha(g);this._hash.update(a)}inherits(Hmac,Base);Hmac.prototype._update=function(a){this._hash.update(a)};Hmac.prototype._final=function(){var a=this._hash.digest();var b=this._alg==="rmd160"?new RIPEMD160():sha(this._alg);return b.update(this._opad).update(a).digest()};module.exports=function createHmac(b,a){b=b.toLowerCase();if(b==="rmd160"||b==="ripemd160"){return new Hmac("rmd160",a)}if(b==="md5"){return new Legacy(md5,a)}return new Hmac(b,a)};