"use strict";var inherits=require("inherits");var Buffer=require("safe-buffer").Buffer;var Base=require("cipher-base");var ZEROS=Buffer.alloc(128);var blocksize=64;function Hmac(e,c){Base.call(this,"digest");if(typeof c==="string"){c=Buffer.from(c)}this._alg=e;this._key=c;if(c.length>blocksize){c=e(c)}else{if(c.length<blocksize){c=Buffer.concat([c,ZEROS],blocksize)}}var a=this._ipad=Buffer.allocUnsafe(blocksize);var d=this._opad=Buffer.allocUnsafe(blocksize);for(var b=0;b<blocksize;b++){a[b]=c[b]^54;d[b]=c[b]^92}this._hash=[a]}inherits(Hmac,Base);Hmac.prototype._update=function(a){this._hash.push(a)};Hmac.prototype._final=function(){var a=this._alg(Buffer.concat(this._hash));return this._alg(Buffer.concat([this._opad,a]))};module.exports=Hmac;