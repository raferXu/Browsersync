var getPaths=require("./getPaths");var forEachBail=require("./forEachBail");function SymlinkPlugin(a,b){this.source=a;this.target=b}module.exports=SymlinkPlugin;SymlinkPlugin.prototype.apply=function(b){var a=this.target;b.plugin(this.source,function(f,j){var i=this;var d=i.fileSystem;var g=getPaths(f.path);var c=g.seqments;var h=g.paths;var e=false;forEachBail.withIndex(h,function(l,k,m){d.readlink(l,function(o,n){if(!o&&n){c[k]=n;e=true;if(/^(\/|[a-zA-z]:($|\\))/.test(n)){return m(null,k)}}m()})},function(m,l){if(!e){return j()}var n=typeof l==="number"?c.slice(0,l+1):c.slice();var k=n.reverse().reduce(function(q,p){return i.join(q,p)});var o=Object.assign({},f,{path:k});b.doResolve(a,o,"resolved symlink to "+k,j)})})};