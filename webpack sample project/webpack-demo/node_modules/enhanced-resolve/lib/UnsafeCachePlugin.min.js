var createInnerCallback=require("./createInnerCallback");function UnsafeCachePlugin(d,c,b,a,e){this.source=d;this.filterPredicate=c;this.withContext=a;this.cache=b||{};this.target=e}module.exports=UnsafeCachePlugin;function getCacheId(b,a){return JSON.stringify({context:a?b.context:"",path:b.path,query:b.query,request:b.request})}UnsafeCachePlugin.prototype.apply=function(e){var c=this.filterPredicate;var b=this.cache;var d=this.target;var a=this.withContext;e.plugin(this.source,function(f,i){if(!c(f)){return i()}var h=getCacheId(f,a);var g=b[h];if(g){return i(null,g)}e.doResolve(d,f,null,createInnerCallback(function(k,j){if(k){return i(k)}if(j){return i(null,b[h]=j)}i()},i))})};