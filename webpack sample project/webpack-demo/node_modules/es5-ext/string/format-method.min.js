"use strict";var isCallable=require("../object/is-callable"),value=require("../object/valid-value"),call=Function.prototype.call;module.exports=function(a){a=Object(value(a));return function(c){var b=this;value(b);c=String(c);return c.replace(/%([a-zA-Z]+)|\\([\u0000-\uffff])/g,function(f,h,e){var g,d;if(e){return e}g=h;while(g&&!(d=a[g])){g=g.slice(0,-1)}if(!d){return f}if(isCallable(d)){d=call.call(d,b)}return d+h.slice(g.length)})}};