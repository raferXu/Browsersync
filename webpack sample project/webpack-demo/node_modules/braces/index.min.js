/*!
 * braces <https://github.com/jonschlinkert/braces>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */
;"use strict";var expand=require("expand-range");var repeat=require("repeat-element");var tokens=require("preserve");module.exports=function(b,a){if(typeof b!=="string"){throw new Error("braces expects a string")}return braces(b,a)};function braces(n,j,s){if(n===""){return[]}if(!Array.isArray(j)){s=j;j=[]}var a=s||{};j=j||[];if(typeof a.nodupes==="undefined"){a.nodupes=true}var p=a.fn;var l;if(typeof a==="function"){p=a;a={}}if(!(patternRe instanceof RegExp)){patternRe=patternRegex()}var h=n.match(patternRe)||[];var e=h[0];switch(e){case"\\,":return escapeCommas(n,j,a);case"\\.":return escapeDots(n,j,a);case"/.":return escapePaths(n,j,a);case" ":return splitWhitespace(n);case"{,}":return exponential(n,a,braces);case"{}":return emptyBraces(n,j,a);case"\\{":case"\\}":return escapeBraces(n,j,a);case"${":if(!/\{[^{]+\{/.test(n)){return j.concat(n)}else{l=true;n=tokens.before(n,es6Regex())}}if(!(braceRe instanceof RegExp)){braceRe=braceRegex()}var g=braceRe.exec(n);if(g==null){return[n]}var o=g[1];var r=g[2];if(r===""){return[n]}var c,b;if(r.indexOf("..")!==-1){c=expand(r,a,p)||r.split(",");b=c.length}else{if(r[0]==='"'||r[0]==="'"){return j.concat(n.split(/['"]/).join(""))}else{c=r.split(",");if(a.makeRe){return braces(n.replace(o,wrap(c,"|")),a)}b=c.length;if(b===1&&a.bash){c[0]=wrap(c[0],"\\")}}}var k=c.length;var f=0,d;while(k--){var q=c[f++];if(/(\.[^.\/])/.test(q)){if(b>1){return c}else{return[n]}}d=splice(n,o,q);if(/\{[^{}]+?\}/.test(d)){j=braces(d,j,a)}else{if(d!==""){if(a.nodupes&&j.indexOf(d)!==-1){continue}j.push(l?tokens.after(d):d)}}}if(a.strict){return filter(j,filterEmpty)}return j}function exponential(k,o,l){if(typeof o==="function"){l=o;o=null}var a=o||{};var j="__ESC_EXP__";var b=0;var h;var c=k.split("{,}");if(a.nodupes){return l(c.join(""),a)}b=c.length-1;h=l(c.join(j),a);var g=h.length;var f=[];var d=0;while(g--){var n=h[d++];var m=n.indexOf(j);if(m===-1){f.push(n)}else{n=n.split("__ESC_EXP__").join("");if(!!n&&a.nodupes!==false){f.push(n)}else{var e=Math.pow(2,b);f.push.apply(f,repeat(n,e))}}}return f}function wrap(b,a){if(a==="|"){return"("+b.join(a)+")"}if(a===","){return"{"+b.join(a)+"}"}if(a==="-"){return"["+b.join(a)+"]"}if(a==="\\"){return"\\{"+b+"\\}"}}function emptyBraces(c,a,b){return braces(c.split("{}").join("\\{\\}"),a,b)}function filterEmpty(a){return !!a&&a!=="\\"}function splitWhitespace(e){var b=e.split(" ");var a=b.length;var d=[];var c=0;while(a--){d.push.apply(d,braces(b[c++]))}return d}function escapeBraces(c,a,b){if(!/\{[^{]+\{/.test(c)){return a.concat(c.split("\\").join(""))}else{c=c.split("\\{").join("__LT_BRACE__");c=c.split("\\}").join("__RT_BRACE__");return map(braces(c,a,b),function(d){d=d.split("__LT_BRACE__").join("{");return d.split("__RT_BRACE__").join("}")})}}function escapeDots(c,a,b){if(!/[^\\]\..+\\\./.test(c)){return a.concat(c.split("\\").join(""))}else{c=c.split("\\.").join("__ESC_DOT__");return map(braces(c,a,b),function(d){return d.split("__ESC_DOT__").join(".")})}}function escapePaths(c,a,b){c=c.split("/.").join("__ESC_PATH__");return map(braces(c,a,b),function(d){return d.split("__ESC_PATH__").join("/.")})}function escapeCommas(c,a,b){if(!/\w,/.test(c)){return a.concat(c.split("\\").join(""))}else{c=c.split("\\,").join("__ESC_COMMA__");return map(braces(c,a,b),function(d){return d.split("__ESC_COMMA__").join(",")})}}function patternRegex(){return/\${|( (?=[{,}])|(?=[{,}]) )|{}|{,}|\\,(?=.*[{}])|\/\.(?=.*[{}])|\\\.(?={)|\\{|\\}/}function braceRegex(){return/.*(\\?\{([^}]+)\})/}function es6Regex(){return/\$\{([^}]+)\}/}var braceRe;var patternRe;function splice(d,b,c){var a=d.indexOf(b);return d.substr(0,a)+c+d.substr(a+b.length)}function map(b,e){if(b==null){return[]}var a=b.length;var d=new Array(a);var c=-1;while(++c<a){d[c]=e(b[c],c,b)}return d}function filter(c,b){if(c==null){return[]}if(typeof b!=="function"){throw new TypeError("braces: filter expects a callback function.")}var a=c.length;var e=c.slice();var d=0;while(a--){if(!b(c[a],d++)){e.splice(a,1)}}return e};