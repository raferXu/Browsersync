var bn=require("bn.js");var randomBytes=require("randombytes");module.exports=crt;function blind(b){var c=getr(b);var a=c.toRed(bn.mont(b.modulus)).redPow(new bn(b.publicExponent)).fromRed();return{blinder:a,unblinder:c.invm(b.modulus)}}function crt(c,m){var f=blind(m);var i=m.modulus.byteLength();var k=bn.mont(m.modulus);var j=new bn(c).mul(f.blinder).umod(m.modulus);var e=j.toRed(bn.mont(m.prime1));var d=j.toRed(bn.mont(m.prime2));var o=m.coefficient;var b=m.prime1;var a=m.prime2;var n=e.redPow(m.exponent1);var l=d.redPow(m.exponent2);n=n.fromRed();l=l.fromRed();var g=n.isub(l).imul(o).umod(b);g.imul(a);l.iadd(g);return new Buffer(l.imul(f.unblinder).umod(m.modulus).toArray(false,i))}crt.getr=getr;function getr(b){var a=b.modulus.byteLength();var c=new bn(randomBytes(a));while(c.cmp(b.modulus)>=0||!c.umod(b.prime1)||!c.umod(b.prime2)){c=new bn(randomBytes(a))}return c};