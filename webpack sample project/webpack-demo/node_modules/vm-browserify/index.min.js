var indexOf=require("indexof");var Object_keys=function(c){if(Object.keys){return Object.keys(c)}else{var b=[];for(var a in c){b.push(a)}return b}};var forEach=function(a,c){if(a.forEach){return a.forEach(c)}else{for(var b=0;b<a.length;b++){c(a[b],b,a)}}};var defineProp=(function(){try{Object.defineProperty({},"_",{});return function(d,b,c){Object.defineProperty(d,b,{writable:true,enumerable:false,configurable:true,value:c})}}catch(a){return function(d,b,c){d[b]=c}}}());var globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function NodeScript(a){if(!(this instanceof Script)){return new Script(a)}this.code=a};Script.prototype.runInContext=function(context){if(!(context instanceof Context)){throw new TypeError("needs a 'context' argument.")}var iframe=document.createElement("iframe");if(!iframe.style){iframe.style={}}iframe.style.display="none";document.body.appendChild(iframe);var win=iframe.contentWindow;var wEval=win.eval,wExecScript=win.execScript;if(!wEval&&wExecScript){wExecScript.call(win,"null");wEval=win.eval}forEach(Object_keys(context),function(key){win[key]=context[key]});forEach(globals,function(key){if(context[key]){win[key]=context[key]}});var winKeys=Object_keys(win);var res=wEval.call(win,this.code);forEach(Object_keys(win),function(key){if(key in context||indexOf(winKeys,key)===-1){context[key]=win[key]}});forEach(globals,function(key){if(!(key in context)){defineProp(context,key,win[key])}});document.body.removeChild(iframe);return res};Script.prototype.runInThisContext=function(){return eval(this.code)};Script.prototype.runInNewContext=function(c){var a=Script.createContext(c);var b=this.runInContext(a);forEach(Object_keys(a),function(d){c[d]=a[d]});return b};forEach(Object_keys(Script.prototype),function(a){exports[a]=Script[a]=function(c){var b=Script(c);return b[a].apply(b,[].slice.call(arguments,1))}});exports.createScript=function(a){return exports.Script(a)};exports.createContext=Script.createContext=function(a){var b=new Context();if(typeof a==="object"){forEach(Object_keys(a),function(c){b[c]=a[c]})}return b};