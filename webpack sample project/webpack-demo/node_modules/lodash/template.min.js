var assignInWith=require("./assignInWith"),attempt=require("./attempt"),baseValues=require("./_baseValues"),customDefaultsAssignIn=require("./_customDefaultsAssignIn"),escapeStringChar=require("./_escapeStringChar"),isError=require("./isError"),isIterateeCall=require("./_isIterateeCall"),keys=require("./keys"),reInterpolate=require("./_reInterpolate"),templateSettings=require("./templateSettings"),toString=require("./toString");var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;function template(g,p,k){var e=templateSettings.imports._.templateSettings||templateSettings;if(k&&isIterateeCall(g,p,k)){p=undefined}g=toString(g);p=assignInWith({},p,e,customDefaultsAssignIn);var c=assignInWith({},p.imports,e.imports,customDefaultsAssignIn),h=keys(c),d=baseValues(c,h);var l,m,i=0,j=p.interpolate||reNoMatch,b="__p += '";var o=RegExp((p.escape||reNoMatch).source+"|"+j.source+"|"+(j===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(p.evaluate||reNoMatch).source+"|$","g");var a="sourceURL" in p?"//# sourceURL="+p.sourceURL+"\n":"";g.replace(o,function(q,u,s,r,t,v){s||(s=r);b+=g.slice(i,v).replace(reUnescapedString,escapeStringChar);if(u){l=true;b+="' +\n__e("+u+") +\n'"}if(t){m=true;b+="';\n"+t+";\n__p += '"}if(s){b+="' +\n((__t = ("+s+")) == null ? '' : __t) +\n'"}i=v+q.length;return q});b+="';\n";var f=p.variable;if(!f){b="with (obj) {\n"+b+"\n}\n"}b=(m?b.replace(reEmptyStringLeading,""):b).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");b="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(l?", __e = _.escape":"")+(m?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+b+"return __p\n}";var n=attempt(function(){return Function(h,a+"return "+b).apply(undefined,d)});n.source=b;if(isError(n)){throw n}return n}module.exports=template;