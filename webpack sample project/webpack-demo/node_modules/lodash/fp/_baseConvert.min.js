var mapping=require("./_mapping"),fallbackHolder=require("./placeholder");var push=Array.prototype.push;function baseArity(a,b){return b==2?function(d,c){return a.apply(undefined,arguments)}:function(c){return a.apply(undefined,arguments)}}function baseAry(a,b){return b==2?function(d,c){return a(d,c)}:function(c){return a(c)}}function cloneArray(c){var b=c?c.length:0,a=Array(b);while(b--){a[b]=c[b]}return a}function createCloner(a){return function(b){return a({},b)}}function flatSpread(a,b){return function(){var e=arguments.length,g=e-1,d=Array(e);while(e--){d[e]=arguments[e]}var f=d[b],c=d.slice(0,b);if(f){push.apply(c,f)}if(b!=g){push.apply(c,d.slice(b+1))}return a.apply(this,c)}}function wrapImmutable(a,b){return function(){var e=arguments.length;if(!e){return}var d=Array(e);while(e--){d[e]=arguments[e]}var c=d[0]=b.apply(undefined,d);a.apply(undefined,d);return c}}function baseConvert(d,i,n,s){var B,l=typeof i=="function",e=i===Object(i);if(e){s=n;n=i;i=undefined}if(n==null){throw new TypeError}s||(s={});var z={cap:"cap" in s?s.cap:true,curry:"curry" in s?s.curry:true,fixed:"fixed" in s?s.fixed:true,immutable:"immutable" in s?s.immutable:true,rearg:"rearg" in s?s.rearg:true};var C=("curry" in s)&&s.curry,E=("fixed" in s)&&s.fixed,h=("rearg" in s)&&s.rearg,v=l?n:fallbackHolder,g=l?n.runInContext():undefined;var x=l?n:{ary:d.ary,assign:d.assign,clone:d.clone,curry:d.curry,forEach:d.forEach,isArray:d.isArray,isFunction:d.isFunction,iteratee:d.iteratee,keys:d.keys,rearg:d.rearg,toInteger:d.toInteger,toPath:d.toPath};var j=x.ary,I=x.assign,p=x.clone,f=x.curry,G=x.forEach,r=x.isArray,k=x.isFunction,u=x.keys,A=x.rearg,y=x.toInteger,a=x.toPath;var K=u(mapping.aryMethod);var J={castArray:function(O){return function(){var P=arguments[0];return r(P)?O(cloneArray(P)):O.apply(undefined,arguments)}},iteratee:function(O){return function(){var R=arguments[0],S=arguments[1],P=O(R,S),Q=P.length;if(z.cap&&typeof S=="number"){S=S>2?(S-2):1;return(Q&&Q<=S)?P:baseAry(P,S)}return P}},mixin:function(O){return function(R){var P=this;if(!k(P)){return O(P,Object(R))}var Q=[];G(u(R),function(S){if(k(R[S])){Q.push([S,P.prototype[S]])}});O(P,Object(R));G(Q,function(T){var S=T[1];if(k(S)){P.prototype[T[0]]=S}else{delete P.prototype[T[0]]}});return P}},nthArg:function(O){return function(Q){var P=Q<0?1:(y(Q)+1);return f(O(Q),P)}},rearg:function(O){return function(Q,P){var R=P?P.length:0;return f(O(Q,P),R)}},runInContext:function(O){return function(P){return baseConvert(d,O(P),s)}}};function H(P,Q){if(z.cap){var O=mapping.iterateeRearg[P];if(O){return b(Q,O)}var R=!l&&mapping.iterateeAry[P];if(R){return F(Q,R)}}return Q}function L(O,P,Q){return(C||(z.curry&&Q>1))?f(P,Q):P}function M(O,P,S){if(z.fixed&&(E||!mapping.skipFixed[O])){var Q=mapping.methodSpread[O],R=Q&&Q.start;return R===undefined?j(P,S):flatSpread(P,R)}return P}function q(O,P,Q){return(z.rearg&&Q>1&&(h||!mapping.skipRearg[O]))?A(P,mapping.methodRearg[O]||mapping.aryRearg[Q]):P}function o(P,V){V=a(V);var R=-1,O=V.length,Q=O-1,W=p(Object(P)),S=W;while(S!=null&&++R<O){var U=V[R],T=S[U];if(T!=null){S[V[R]]=p(R==Q?T:Object(T))}S=S[U]}return W}function c(O){return N.runInContext.convert(O)(undefined)}function m(R,S){var Q=mapping.aliasToReal[R]||R,P=mapping.remap[Q]||Q,O=s;return function(T){var W=l?g:x,U=l?g[P]:S,V=I(I({},O),T);return baseConvert(W,Q,U,V)}}function F(O,P){return t(O,function(Q){return typeof Q=="function"?baseAry(Q,P):Q})}function b(P,O){return t(P,function(Q){var R=O.length;return baseArity(A(baseAry(Q,R),O),R)})}function t(P,O){return function(){var S=arguments.length;if(!S){return P()}var R=Array(S);while(S--){R[S]=arguments[S]}var Q=z.rearg?0:(S-1);R[Q]=O(R[Q]);return P.apply(undefined,R)}}function D(R,S){var O,Q=mapping.aliasToReal[R]||R,P=S,T=J[Q];if(T){P=T(S)}else{if(z.immutable){if(mapping.mutate.array[Q]){P=wrapImmutable(S,cloneArray)}else{if(mapping.mutate.object[Q]){P=wrapImmutable(S,createCloner(S))}else{if(mapping.mutate.set[Q]){P=wrapImmutable(S,o)}}}}}G(K,function(U){G(mapping.aryMethod[U],function(V){if(Q==V){var W=mapping.methodSpread[Q],X=W&&W.afterRearg;O=X?M(Q,q(Q,P,U),U):q(Q,M(Q,P,U),U);O=H(Q,O);O=L(Q,O,U);return false}});return !O});O||(O=P);if(O==S){O=C?f(O,1):function(){return S.apply(this,arguments)}}O.convert=m(Q,S);if(mapping.placeholder[Q]){B=true;O.placeholder=S.placeholder=v}return O}if(!e){return D(i,n)}var N=n;var w=[];G(K,function(O){G(mapping.aryMethod[O],function(P){var Q=N[mapping.remap[P]||P];if(Q){w.push([P,D(P,Q)])}})});G(u(N),function(O){var Q=N[O];if(typeof Q=="function"){var P=w.length;while(P--){if(w[P][0]==O){return}}Q.convert=m(O,Q);w.push([O,Q])}});G(w,function(O){N[O[0]]=O[1]});N.convert=c;if(B){N.placeholder=v}G(u(N),function(O){G(mapping.realToAlias[O]||[],function(P){N[P]=N[O]})});return N}module.exports=baseConvert;