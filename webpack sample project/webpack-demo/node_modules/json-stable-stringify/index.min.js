var json=typeof JSON!=="undefined"?JSON:require("jsonify");module.exports=function(g,d){if(!d){d={}}if(typeof d==="function"){d={cmp:d}}var e=d.space||"";if(typeof e==="number"){e=Array(e+1).join(" ")}var f=(typeof d.cycles==="boolean")?d.cycles:false;var b=d.replacer||function(i,j){return j};var c=d.cmp&&(function(i){return function(j){return function(m,l){var n={key:m,value:j[m]};var k={key:l,value:j[l]};return i(n,k)}}})(d.cmp);var a=[];return(function h(q,r,l,j){var k=e?("\n"+new Array(j+1).join(e)):"";var s=e?": ":":";if(l&&l.toJSON&&typeof l.toJSON==="function"){l=l.toJSON()}l=b.call(q,r,l);if(l===undefined){return}if(typeof l!=="object"||l===null){return json.stringify(l)}if(isArray(l)){var n=[];for(var o=0;o<l.length;o++){var u=h(l,o,l[o],j+1)||json.stringify(null);n.push(k+e+u)}return"["+n.join(",")+k+"]"}else{if(a.indexOf(l)!==-1){if(f){return json.stringify("__cycle__")}throw new TypeError("Converting circular structure to JSON")}else{a.push(l)}var t=objectKeys(l).sort(c&&c(l));var n=[];for(var o=0;o<t.length;o++){var r=t[o];var p=h(l,r,l[r],j+1);if(!p){continue}var m=json.stringify(r)+s+p;n.push(k+e+m)}a.splice(a.indexOf(l),1);return"{"+n.join(",")+k+"}"}})({"":g},"",g,0)};var isArray=Array.isArray||function(a){return{}.toString.call(a)==="[object Array]"};var objectKeys=Object.keys||function(d){var a=Object.prototype.hasOwnProperty||function(){return true};var c=[];for(var b in d){if(a.call(d,b)){c.push(b)}}return c};