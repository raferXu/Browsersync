function Hash(a,b){this._block=new Buffer(a);this._finalSize=b;this._blockSize=a;this._len=0;this._s=0}Hash.prototype.update=function(g,c){if(typeof g==="string"){c=c||"utf8";g=new Buffer(g,c)}var b=this._len+=g.length;var k=this._s||0;var h=0;var d=this._block;while(k<b){var j=Math.min(g.length,h+this._blockSize-(k%this._blockSize));var a=(j-h);for(var e=0;e<a;e++){d[(k%this._blockSize)+e]=g[e+h]}k+=a;h+=a;if((k%this._blockSize)===0){this._update(d)}}this._s=k;return this};Hash.prototype.digest=function(b){var a=this._len*8;this._block[this._len%this._blockSize]=128;this._block.fill(0,this._len%this._blockSize+1);if(a%(this._blockSize*8)>=this._finalSize*8){this._update(this._block);this._block.fill(0)}this._block.writeInt32BE(a,this._blockSize-4);var c=this._update(this._block)||this._hash();return b?c.toString(b):c};Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")};module.exports=Hash;