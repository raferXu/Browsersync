var inherits=require("inherits");var Hash=require("./hash");var K=[1518500249,1859775393,2400959708|0,3395469782|0];var W=new Array(80);function Sha(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha,Hash);Sha.prototype.init=function(){this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520;return this};function rotl5(a){return(a<<5)|(a>>>27)}function rotl30(a){return(a<<30)|(a>>>2)}function ft(e,a,g,f){if(e===0){return(a&g)|((~a)&f)}if(e===2){return(a&g)|(a&f)|(g&f)}return a^g^f}Sha.prototype._update=function(l){var f=this._w;var p=this._a|0;var o=this._b|0;var n=this._c|0;var m=this._d|0;var k=this._e|0;for(var h=0;h<16;++h){f[h]=l.readInt32BE(h*4)}for(;h<80;++h){f[h]=f[h-3]^f[h-8]^f[h-14]^f[h-16]}for(var g=0;g<80;++g){var r=~~(g/20);var q=(rotl5(p)+ft(r,o,n,m)+k+f[g]+K[r])|0;k=m;m=n;n=rotl30(o);o=p;p=q}this._a=(p+this._a)|0;this._b=(o+this._b)|0;this._c=(n+this._c)|0;this._d=(m+this._d)|0;this._e=(k+this._e)|0};Sha.prototype._hash=function(){var a=new Buffer(20);a.writeInt32BE(this._a|0,0);a.writeInt32BE(this._b|0,4);a.writeInt32BE(this._c|0,8);a.writeInt32BE(this._d|0,12);a.writeInt32BE(this._e|0,16);return a};module.exports=Sha;