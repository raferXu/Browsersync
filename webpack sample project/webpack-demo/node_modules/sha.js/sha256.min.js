var inherits=require("inherits");var Hash=require("./hash");var K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var W=new Array(64);function Sha256(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha256,Hash);Sha256.prototype.init=function(){this._a=1779033703;this._b=3144134277;this._c=1013904242;this._d=2773480762;this._e=1359893119;this._f=2600822924;this._g=528734635;this._h=1541459225;return this};function ch(a,c,b){return b^(a&(c^b))}function maj(a,c,b){return(a&c)|(b&(a|c))}function sigma0(a){return(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10)}function sigma1(a){return(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7)}function gamma0(a){return(a>>>7|a<<25)^(a>>>18|a<<14)^(a>>>3)}function gamma1(a){return(a>>>17|a<<15)^(a>>>19|a<<13)^(a>>>10)}Sha256.prototype._update=function(t){var k=this._w;var x=this._a|0;var w=this._b|0;var v=this._c|0;var u=this._d|0;var r=this._e|0;var p=this._f|0;var o=this._g|0;var n=this._h|0;for(var m=0;m<16;++m){k[m]=t.readInt32BE(m*4)}for(;m<64;++m){k[m]=(gamma1(k[m-2])+k[m-7]+gamma0(k[m-15])+k[m-16])|0}for(var l=0;l<64;++l){var s=(n+sigma1(r)+ch(r,p,o)+K[l]+k[l])|0;var q=(sigma0(x)+maj(x,w,v))|0;n=o;o=p;p=r;r=(u+s)|0;u=v;v=w;w=x;x=(s+q)|0}this._a=(x+this._a)|0;this._b=(w+this._b)|0;this._c=(v+this._c)|0;this._d=(u+this._d)|0;this._e=(r+this._e)|0;this._f=(p+this._f)|0;this._g=(o+this._g)|0;this._h=(n+this._h)|0};Sha256.prototype._hash=function(){var a=new Buffer(32);a.writeInt32BE(this._a,0);a.writeInt32BE(this._b,4);a.writeInt32BE(this._c,8);a.writeInt32BE(this._d,12);a.writeInt32BE(this._e,16);a.writeInt32BE(this._f,20);a.writeInt32BE(this._g,24);a.writeInt32BE(this._h,28);return a};module.exports=Sha256;