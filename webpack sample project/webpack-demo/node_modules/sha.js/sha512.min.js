var inherits=require("inherits");var Hash=require("./hash");var K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];var W=new Array(160);function Sha512(){this.init();this._w=W;Hash.call(this,128,112)}inherits(Sha512,Hash);Sha512.prototype.init=function(){this._ah=1779033703;this._bh=3144134277;this._ch=1013904242;this._dh=2773480762;this._eh=1359893119;this._fh=2600822924;this._gh=528734635;this._hh=1541459225;this._al=4089235720;this._bl=2227873595;this._cl=4271175723;this._dl=1595750129;this._el=2917565137;this._fl=725511199;this._gl=4215389547;this._hl=327033209;return this};function Ch(a,c,b){return b^(a&(c^b))}function maj(a,c,b){return(a&c)|(b&(a|c))}function sigma0(a,b){return(a>>>28|b<<4)^(b>>>2|a<<30)^(b>>>7|a<<25)}function sigma1(a,b){return(a>>>14|b<<18)^(a>>>18|b<<14)^(b>>>9|a<<23)}function Gamma0(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^(a>>>7)}function Gamma0l(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^(a>>>7|b<<25)}function Gamma1(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^(a>>>6)}function Gamma1l(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^(a>>>6|b<<26)}function getCarry(d,c){return(d>>>0)<(c>>>0)?1:0}Sha512.prototype._update=function(f){var b=this._w;var k=this._ah|0;var S=this._bh|0;var A=this._ch|0;var m=this._dh|0;var U=this._eh|0;var B=this._fh|0;var n=this._gh|0;var X=this._hh|0;var g=this._al|0;var N=this._bl|0;var v=this._cl|0;var h=this._dl|0;var Q=this._el|0;var z=this._fl|0;var l=this._gl|0;var T=this._hl|0;for(var O=0;O<32;O+=2){b[O]=f.readInt32BE(O*4);b[O+1]=f.readInt32BE(O*4+4)}for(;O<160;O+=2){var F=b[O-15*2];var E=b[O-15*2+1];var y=Gamma0(F,E);var e=Gamma0l(E,F);F=b[O-2*2];E=b[O-2*2+1];var w=Gamma1(F,E);var I=Gamma1l(E,F);var t=b[O-7*2];var q=b[O-7*2+1];var P=b[O-16*2];var J=b[O-16*2+1];var u=(e+q)|0;var x=(y+t+getCarry(u,e))|0;u=(u+I)|0;x=(x+w+getCarry(u,I))|0;u=(u+J)|0;x=(x+P+getCarry(u,J))|0;b[O]=x;b[O+1]=u}for(var L=0;L<160;L+=2){x=b[L];u=b[L+1];var H=maj(k,S,A);var G=maj(g,N,v);var a=sigma0(k,g);var Y=sigma0(g,k);var D=sigma1(U,Q);var C=sigma1(Q,U);var V=K[L];var R=K[L+1];var s=Ch(U,B,n);var p=Ch(Q,z,l);var o=(T+C)|0;var r=(X+D+getCarry(o,T))|0;o=(o+p)|0;r=(r+s+getCarry(o,p))|0;o=(o+R)|0;r=(r+V+getCarry(o,R))|0;o=(o+u)|0;r=(r+x+getCarry(o,u))|0;var c=(Y+G)|0;var d=(a+H+getCarry(c,Y))|0;X=n;T=l;n=B;l=z;B=U;z=Q;Q=(h+o)|0;U=(m+r+getCarry(Q,h))|0;m=A;h=v;A=S;v=N;S=k;N=g;g=(o+c)|0;k=(r+d+getCarry(g,o))|0}this._al=(this._al+g)|0;this._bl=(this._bl+N)|0;this._cl=(this._cl+v)|0;this._dl=(this._dl+h)|0;this._el=(this._el+Q)|0;this._fl=(this._fl+z)|0;this._gl=(this._gl+l)|0;this._hl=(this._hl+T)|0;this._ah=(this._ah+k+getCarry(this._al,g))|0;this._bh=(this._bh+S+getCarry(this._bl,N))|0;this._ch=(this._ch+A+getCarry(this._cl,v))|0;this._dh=(this._dh+m+getCarry(this._dl,h))|0;this._eh=(this._eh+U+getCarry(this._el,Q))|0;this._fh=(this._fh+B+getCarry(this._fl,z))|0;this._gh=(this._gh+n+getCarry(this._gl,l))|0;this._hh=(this._hh+X+getCarry(this._hl,T))|0};Sha512.prototype._hash=function(){var a=new Buffer(64);function b(d,c,e){a.writeInt32BE(d,e);a.writeInt32BE(c,e+4)}b(this._ah,this._al,0);b(this._bh,this._bl,8);b(this._ch,this._cl,16);b(this._dh,this._dl,24);b(this._eh,this._el,32);b(this._fh,this._fl,40);b(this._gh,this._gl,48);b(this._hh,this._hl,56);return a};module.exports=Sha512;