"use strict";var utils=exports;var BN=require("bn.js");var minAssert=require("minimalistic-assert");var minUtils=require("minimalistic-crypto-utils");utils.assert=minAssert;utils.toArray=minUtils.toArray;utils.zero2=minUtils.zero2;utils.toHex=minUtils.toHex;utils.encode=minUtils.encode;function getNAF(d,j){var h=[];var e=1<<(j+1);var b=d.clone();while(b.cmpn(1)>=0){var f;if(b.isOdd()){var g=b.andln(e-1);if(g>(e>>1)-1){f=(e>>1)-g}else{f=g}b.isubn(f)}else{f=0}h.push(f);var a=(b.cmpn(0)!==0&&b.andln(e-1)===0)?(j+1):1;for(var c=1;c<a;c++){h.push(0)}b.iushrn(a)}return h}utils.getNAF=getNAF;function getJSF(j,g){var h=[[],[]];j=j.clone();g=g.clone();var c=0;var b=0;while(j.cmpn(-c)>0||g.cmpn(-b)>0){var f=(j.andln(3)+c)&3;var a=(g.andln(3)+b)&3;if(f===3){f=-1}if(a===3){a=-1}var e;if((f&1)===0){e=0}else{var i=(j.andln(7)+c)&7;if((i===3||i===5)&&a===2){e=-f}else{e=f}}h[0].push(e);var d;if((a&1)===0){d=0}else{var i=(g.andln(7)+b)&7;if((i===3||i===5)&&f===2){d=-a}else{d=a}}h[1].push(d);if(2*c===e+1){c=1-c}if(2*b===d+1){b=1-b}j.iushrn(1);g.iushrn(1)}return h}utils.getJSF=getJSF;function cachedProperty(e,b,a){var c="_"+b;e.prototype[b]=function d(){return this[c]!==undefined?this[c]:this[c]=a.call(this)}}utils.cachedProperty=cachedProperty;function parseBytes(a){return typeof a==="string"?utils.toArray(a,"hex"):a}utils.parseBytes=parseBytes;function intFromLE(a){return new BN(a,"hex","le")}utils.intFromLE=intFromLE;