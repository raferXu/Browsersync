"use strict";var elliptic=require("../../elliptic");var utils=elliptic.utils;var assert=utils.assert;var parseBytes=utils.parseBytes;var cachedProperty=utils.cachedProperty;function KeyPair(a,b){this.eddsa=a;this._secret=parseBytes(b.secret);if(a.isPoint(b.pub)){this._pub=b.pub}else{this._pubBytes=parseBytes(b.pub)}}KeyPair.fromPublic=function fromPublic(a,b){if(b instanceof KeyPair){return b}return new KeyPair(a,{pub:b})};KeyPair.fromSecret=function fromSecret(b,a){if(a instanceof KeyPair){return a}return new KeyPair(b,{secret:a})};KeyPair.prototype.secret=function secret(){return this._secret};cachedProperty(KeyPair,"pubBytes",function pubBytes(){return this.eddsa.encodePoint(this.pub())});cachedProperty(KeyPair,"pub",function pub(){if(this._pubBytes){return this.eddsa.decodePoint(this._pubBytes)}return this.eddsa.g.mul(this.priv())});cachedProperty(KeyPair,"privBytes",function privBytes(){var d=this.eddsa;var e=this.hash();var b=d.encodingLength-1;var c=e.slice(0,d.encodingLength);c[0]&=248;c[b]&=127;c[b]|=64;return c});cachedProperty(KeyPair,"priv",function priv(){return this.eddsa.decodeInt(this.privBytes())});cachedProperty(KeyPair,"hash",function hash(){return this.eddsa.hash().update(this.secret()).digest()});cachedProperty(KeyPair,"messagePrefix",function messagePrefix(){return this.hash().slice(this.eddsa.encodingLength)});KeyPair.prototype.sign=function sign(a){assert(this._secret,"KeyPair can only verify");return this.eddsa.sign(a,this)};KeyPair.prototype.verify=function verify(a,b){return this.eddsa.verify(a,b,this)};KeyPair.prototype.getSecret=function getSecret(a){assert(this._secret,"KeyPair is public only");return utils.encode(this.secret(),a)};KeyPair.prototype.getPublic=function getPublic(a){return utils.encode(this.pubBytes(),a)};module.exports=KeyPair;