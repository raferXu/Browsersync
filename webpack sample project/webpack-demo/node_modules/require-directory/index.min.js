"use strict";var fs=require("fs"),join=require("path").join,resolve=require("path").resolve,dirname=require("path").dirname,defaultOptions={extensions:["js","json","coffee"],recurse:true,rename:function(a){return a},visit:function(a){return a}};function checkFileInclusion(c,a,b){return((new RegExp("\\.("+b.extensions.join("|")+")$","i").test(a))&&!(b.include&&b.include instanceof RegExp&&!b.include.test(c))&&!(b.include&&typeof b.include==="function"&&!b.include(c,a))&&!(b.exclude&&b.exclude instanceof RegExp&&b.exclude.test(c))&&!(b.exclude&&typeof b.exclude==="function"&&b.exclude(c,a)))}function requireDirectory(a,d,c){var b={};if(d&&!c&&typeof d!=="string"){c=d;d=null}c=c||{};for(var e in defaultOptions){if(typeof c[e]==="undefined"){c[e]=defaultOptions[e]}}d=!d?dirname(a.filename):resolve(dirname(a.filename),d);fs.readdirSync(d).forEach(function(f){var i=join(d,f),h,g,j;if(fs.statSync(i).isDirectory()&&c.recurse){h=requireDirectory(a,i,c);if(Object.keys(h).length){b[c.rename(f,i,f)]=h}}else{if(i!==a.filename&&checkFileInclusion(i,f,c)){g=f.substring(0,f.lastIndexOf("."));j=a.require(i);b[c.rename(g,i,f)]=c.visit(j,i,f)||j}}});return b}module.exports=requireDirectory;module.exports.defaults=defaultOptions;