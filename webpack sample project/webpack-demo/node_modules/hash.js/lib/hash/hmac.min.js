"use strict";var utils=require("./utils");var assert=require("minimalistic-assert");function Hmac(c,b,a){if(!(this instanceof Hmac)){return new Hmac(c,b,a)}this.Hash=c;this.blockSize=c.blockSize/8;this.outSize=c.outSize/8;this.inner=null;this.outer=null;this._init(utils.toArray(b,a))}module.exports=Hmac;Hmac.prototype._init=function init(b){if(b.length>this.blockSize){b=new this.Hash().update(b).digest()}assert(b.length<=this.blockSize);for(var a=b.length;a<this.blockSize;a++){b.push(0)}for(a=0;a<b.length;a++){b[a]^=54}this.inner=new this.Hash().update(b);for(a=0;a<b.length;a++){b[a]^=106}this.outer=new this.Hash().update(b)};Hmac.prototype.update=function update(b,a){this.inner.update(b,a);return this};Hmac.prototype.digest=function digest(a){this.outer.update(this.inner.digest());return this.outer.digest(a)};