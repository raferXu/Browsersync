"use strict";var utils=require("../utils");var common=require("../common");var shaCommon=require("./common");var rotl32=utils.rotl32;var sum32=utils.sum32;var sum32_5=utils.sum32_5;var ft_1=shaCommon.ft_1;var BlockHash=common.BlockHash;var sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1)){return new SHA1()}BlockHash.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.W=new Array(80)}utils.inherits(SHA1,BlockHash);module.exports=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function _update(g,f){var h=this.W;for(var j=0;j<16;j++){h[j]=g[f+j]}for(;j<h.length;j++){h[j]=rotl32(h[j-3]^h[j-8]^h[j-14]^h[j-16],1)}var o=this.h[0];var n=this.h[1];var m=this.h[2];var l=this.h[3];var k=this.h[4];for(j=0;j<h.length;j++){var q=~~(j/20);var p=sum32_5(rotl32(o,5),ft_1(q,n,m,l),k,h[j],sha1_K[q]);k=l;l=m;m=rotl32(n,30);n=o;o=p}this.h[0]=sum32(this.h[0],o);this.h[1]=sum32(this.h[1],n);this.h[2]=sum32(this.h[2],m);this.h[3]=sum32(this.h[3],l);this.h[4]=sum32(this.h[4],k)};SHA1.prototype._digest=function digest(a){if(a==="hex"){return utils.toHex32(this.h,"big")}else{return utils.split32(this.h,"big")}};