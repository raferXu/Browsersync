"use strict";var utils=require("../utils");var common=require("../common");var assert=require("minimalistic-assert");var rotr64_hi=utils.rotr64_hi;var rotr64_lo=utils.rotr64_lo;var shr64_hi=utils.shr64_hi;var shr64_lo=utils.shr64_lo;var sum64=utils.sum64;var sum64_hi=utils.sum64_hi;var sum64_lo=utils.sum64_lo;var sum64_4_hi=utils.sum64_4_hi;var sum64_4_lo=utils.sum64_4_lo;var sum64_5_hi=utils.sum64_5_hi;var sum64_5_lo=utils.sum64_5_lo;var BlockHash=common.BlockHash;var sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512(){if(!(this instanceof SHA512)){return new SHA512()}BlockHash.call(this);this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209];this.k=sha512_K;this.W=new Array(160)}utils.inherits(SHA512,BlockHash);module.exports=SHA512;SHA512.blockSize=1024;SHA512.outSize=512;SHA512.hmacStrength=192;SHA512.padLength=128;SHA512.prototype._prepareBlock=function _prepareBlock(c,a){var d=this.W;for(var g=0;g<32;g++){d[g]=c[a+g]}for(;g<d.length;g+=2){var k=g1_512_hi(d[g-4],d[g-3]);var b=g1_512_lo(d[g-4],d[g-3]);var h=d[g-14];var l=d[g-13];var e=g0_512_hi(d[g-30],d[g-29]);var j=g0_512_lo(d[g-30],d[g-29]);var m=d[g-32];var f=d[g-31];d[g]=sum64_4_hi(k,b,h,l,e,j,m,f);d[g+1]=sum64_4_lo(k,b,h,l,e,j,m,f)}};SHA512.prototype._update=function _update(o,m){this._prepareBlock(o,m);var g=this.W;var D=this.h[0];var y=this.h[1];var f=this.h[2];var a=this.h[3];var u=this.h[4];var r=this.h[5];var E=this.h[6];var z=this.h[7];var h=this.h[8];var c=this.h[9];var v=this.h[10];var s=this.h[11];var G=this.h[12];var B=this.h[13];var k=this.h[14];var e=this.h[15];assert(this.k.length===g.length);for(var A=0;A<g.length;A+=2){var H=k;var j=e;var d=s1_512_hi(h,c);var p=s1_512_lo(h,c);var n=ch64_hi(h,c,v,s,G,B);var t=ch64_lo(h,c,v,s,G,B);var q=this.k[A];var x=this.k[A+1];var w=g[A];var C=g[A+1];var F=sum64_5_hi(H,j,d,p,n,t,q,x,w,C);var b=sum64_5_lo(H,j,d,p,n,t,q,x,w,C);H=s0_512_hi(D,y);j=s0_512_lo(D,y);d=maj64_hi(D,y,f,a,u,r);p=maj64_lo(D,y,f,a,u,r);var I=sum64_hi(H,j,d,p);var l=sum64_lo(H,j,d,p);k=G;e=B;G=v;B=s;v=h;s=c;h=sum64_hi(E,z,F,b);c=sum64_lo(z,z,F,b);E=u;z=r;u=f;r=a;f=D;a=y;D=sum64_hi(F,b,I,l);y=sum64_lo(F,b,I,l)}sum64(this.h,0,D,y);sum64(this.h,2,f,a);sum64(this.h,4,u,r);sum64(this.h,6,E,z);sum64(this.h,8,h,c);sum64(this.h,10,v,s);sum64(this.h,12,G,B);sum64(this.h,14,k,e)};SHA512.prototype._digest=function digest(a){if(a==="hex"){return utils.toHex32(this.h,"big")}else{return utils.split32(this.h,"big")}};function ch64_hi(b,f,c,a,e){var d=(b&c)^((~b)&e);if(d<0){d+=4294967296}return d}function ch64_lo(c,g,d,a,f,b){var e=(g&a)^((~g)&b);if(e<0){e+=4294967296}return e}function maj64_hi(b,f,c,a,e){var d=(b&c)^(b&e)^(c&e);if(d<0){d+=4294967296}return d}function maj64_lo(c,g,d,a,f,b){var e=(g&a)^(g&b)^(a&b);if(e<0){e+=4294967296}return e}function s0_512_hi(b,f){var e=rotr64_hi(b,f,28);var c=rotr64_hi(f,b,2);var a=rotr64_hi(f,b,7);var d=e^c^a;if(d<0){d+=4294967296}return d}function s0_512_lo(b,f){var e=rotr64_lo(b,f,28);var d=rotr64_lo(f,b,2);var a=rotr64_lo(f,b,7);var c=e^d^a;if(c<0){c+=4294967296}return c}function s1_512_hi(b,f){var e=rotr64_hi(b,f,14);var c=rotr64_hi(b,f,18);var a=rotr64_hi(f,b,9);var d=e^c^a;if(d<0){d+=4294967296}return d}function s1_512_lo(b,f){var e=rotr64_lo(b,f,14);var d=rotr64_lo(b,f,18);var a=rotr64_lo(f,b,9);var c=e^d^a;if(c<0){c+=4294967296}return c}function g0_512_hi(b,f){var e=rotr64_hi(b,f,1);var c=rotr64_hi(b,f,8);var a=shr64_hi(b,f,7);var d=e^c^a;if(d<0){d+=4294967296}return d}function g0_512_lo(b,f){var e=rotr64_lo(b,f,1);var d=rotr64_lo(b,f,8);var a=shr64_lo(b,f,7);var c=e^d^a;if(c<0){c+=4294967296}return c}function g1_512_hi(b,f){var e=rotr64_hi(b,f,19);var c=rotr64_hi(f,b,29);var a=shr64_hi(b,f,6);var d=e^c^a;if(d<0){d+=4294967296}return d}function g1_512_lo(b,f){var e=rotr64_lo(b,f,19);var d=rotr64_lo(f,b,29);var a=shr64_lo(b,f,6);var c=e^d^a;if(c<0){c+=4294967296}return c};