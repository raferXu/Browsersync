"use strict";var utils=require("./utils");var common=require("./common");var rotl32=utils.rotl32;var sum32=utils.sum32;var sum32_3=utils.sum32_3;var sum32_4=utils.sum32_4;var BlockHash=common.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160)){return new RIPEMD160()}BlockHash.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.endian="little"}utils.inherits(RIPEMD160,BlockHash);exports.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function update(h,c){var g=this.h[0];var d=this.h[1];var b=this.h[2];var a=this.h[3];var p=this.h[4];var o=g;var m=d;var e=b;var n=a;var l=p;for(var k=0;k<80;k++){var i=sum32(rotl32(sum32_4(g,f(k,d,b,a),h[r[k]+c],K(k)),s[k]),p);g=p;p=a;a=rotl32(b,10);b=d;d=i;i=sum32(rotl32(sum32_4(o,f(79-k,m,e,n),h[rh[k]+c],Kh(k)),sh[k]),l);o=l;l=n;n=rotl32(e,10);e=m;m=i}i=sum32_3(this.h[1],b,n);this.h[1]=sum32_3(this.h[2],a,l);this.h[2]=sum32_3(this.h[3],p,o);this.h[3]=sum32_3(this.h[4],g,m);this.h[4]=sum32_3(this.h[0],d,e);this.h[0]=i};RIPEMD160.prototype._digest=function digest(a){if(a==="hex"){return utils.toHex32(this.h,"little")}else{return utils.split32(this.h,"little")}};function f(b,a,d,c){if(b<=15){return a^d^c}else{if(b<=31){return(a&d)|((~a)&c)}else{if(b<=47){return(a|(~d))^c}else{if(b<=63){return(a&c)|(d&(~c))}else{return a^(d|(~c))}}}}}function K(a){if(a<=15){return 0}else{if(a<=31){return 1518500249}else{if(a<=47){return 1859775393}else{if(a<=63){return 2400959708}else{return 2840853838}}}}}function Kh(a){if(a<=15){return 1352829926}else{if(a<=31){return 1548603684}else{if(a<=47){return 1836072691}else{if(a<=63){return 2053994217}else{return 0}}}}}var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];