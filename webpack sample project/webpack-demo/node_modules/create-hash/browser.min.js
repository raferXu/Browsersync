"use strict";var inherits=require("inherits");var md5=require("./md5");var RIPEMD160=require("ripemd160");var sha=require("sha.js");var Base=require("cipher-base");function HashNoConstructor(a){Base.call(this,"digest");this._hash=a;this.buffers=[]}inherits(HashNoConstructor,Base);HashNoConstructor.prototype._update=function(a){this.buffers.push(a)};HashNoConstructor.prototype._final=function(){var a=Buffer.concat(this.buffers);var b=this._hash(a);this.buffers=null;return b};function Hash(a){Base.call(this,"digest");this._hash=a}inherits(Hash,Base);Hash.prototype._update=function(a){this._hash.update(a)};Hash.prototype._final=function(){return this._hash.digest()};module.exports=function createHash(a){a=a.toLowerCase();if(a==="md5"){return new HashNoConstructor(md5)}if(a==="rmd160"||a==="ripemd160"){return new Hash(new RIPEMD160())}return new Hash(sha(a))};