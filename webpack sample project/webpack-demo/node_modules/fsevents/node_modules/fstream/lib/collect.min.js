module.exports=collect;function collect(f){if(f._collected){return}if(f._paused){return f.on("resume",collect.bind(null,f))}f._collected=true;f.pause();f.on("data",c);f.on("end",c);var b=[];function c(g){if(typeof g==="string"){g=new Buffer(g)}if(Buffer.isBuffer(g)&&!g.length){return}b.push(g)}f.on("entry",a);var d=[];function a(g){collect(g);d.push(g)}f.on("proxy",e);function e(g){g.pause()}f.pipe=(function(g){return function(h){var j=0;(function k(){var l=d[j++];if(!l){return i()}l.on("end",k);if(h){h.add(l)}else{f.emit("entry",l)}})();function i(){f.removeListener("entry",a);f.removeListener("data",c);f.removeListener("end",c);f.pipe=g;if(h){f.pipe(h)}b.forEach(function(l){if(l){f.emit("data",l)}else{f.emit("end")}});f.resume()}return h}})(f.pipe)};