"use strict";var core=require("./core");var utils=require("./utils");var ns={};function curve25519_raw(i,j){var l,m,e;m=j;l=core.dbl(m,core.ONE());e=[m,core.ONE()];var g=255;while(core.getbit(i,g)==0){g--;if(g<0){return core.ZERO()}}g--;var h=[l,e];while(g>=0){var d,o;var k=core.getbit(i,g);d=core.sum(h[0][0],h[0][1],h[1][0],h[1][1],m);o=core.dbl(h[1-k][0],h[1-k][1]);h[1-k]=o;h[k]=d;g--}e=h[1];e[1]=core.invmodp(e[1]);e[0]=core.mulmodp(e[0],e[1]);core.reduce(e[0]);return e[0]}function curve25519b32(d,c){return _base32encode(curve25519(_base32decode(d),_base32decode(c)))}function curve25519(a,b){if(!b){b=core.BASE()}a[0]&=65528;a[15]=(a[15]&32767)|16384;return curve25519_raw(a,b)}function _hexEncodeVector(b){var a=utils.hexEncode(b);a=new Array(64+1-a.length).join("0")+a;return a.split(/(..)/).reverse().join("")}function _hexDecodeVector(b){var a=b.split(/(..)/).reverse().join("");return utils.hexDecode(a)}ns.curve25519=curve25519;ns.curve25519_raw=curve25519_raw;ns.hexEncodeVector=_hexEncodeVector;ns.hexDecodeVector=_hexDecodeVector;ns.hexencode=utils.hexEncode;ns.hexdecode=utils.hexDecode;ns.base32encode=utils.base32encode;ns.base32decode=utils.base32decode;module.exports=ns;