"use strict";var core=require("./core");var utils=require("./utils");var curve255=require("./curve255");var ns={};function _toString(a){var b=new Uint16Array(a);return(new Buffer(new Uint8Array(b.buffer)))}function _fromString(c){if(Buffer.isBuffer(c)){var d=new Uint8Array(c);return(new Uint16Array(d.buffer))}var a=new Array(16);for(var e=0,b=0;e<c.length;e+=2){a[b]=(c.charCodeAt(e+1)<<8)|c.charCodeAt(e);b++}return a}ns.computeKey=function(b,a){if(a){return _toString(curve255.curve25519(_fromString(b),_fromString(a)))}else{return _toString(curve255.curve25519(_fromString(b)))}};ns.publicKey=function(a){return _toString(curve255.curve25519(_fromString(a)))};ns.generateKey=function(){return core.generateKey(true)};module.exports=ns;