var async=require("./async.js");module.exports={iterator:wrapIterator,callback:wrapCallback};function wrapIterator(a){var b=this;return function(f,e,c){var d,g=async(wrapIteratorCallback.call(b,c,e));b.jobs[e]=g;if(a.length==2){d=a(f,g)}else{d=a(f,e,g)}return d}}function wrapCallback(c){var b=this;var a=function(e,d){return finisher.call(b,e,d,c)};return a}function wrapIteratorCallback(c,a){var b=this;return function(e,d){if(!(a in b.jobs)){c(e,d);return}delete b.jobs[a];return streamer.call(b,e,{key:a,value:d},c)}}function streamer(b,a,c){if(b&&!this.error){this.error=b;this.pause();this.emit("error",b);c(b,a&&a.value);return}this.push(a);c(b,a&&a.value)}function finisher(b,a,c){if(!b){this.push(null)}c(b,a)};