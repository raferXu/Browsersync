"use strict";var IDENTIFIER=/^[a-z_$][a-z0-9_$\-]*$/i;var customRuleCode=require("./dotjs/custom");module.exports={add:addKeyword,get:getKeyword,remove:removeKeyword};function addKeyword(d,a){var g=this.RULES;if(g.keywords[d]){throw new Error("Keyword "+d+" is already defined")}if(!IDENTIFIER.test(d)){throw new Error("Keyword "+d+" is not a valid identifier")}if(a){if(a.macro&&a.valid!==undefined){throw new Error('"valid" option cannot be used with macro keywords')}var h=a.type;if(Array.isArray(h)){var c,e=h.length;for(c=0;c<e;c++){k(h[c])}for(c=0;c<e;c++){f(d,h[c],a)}}else{if(h){k(h)}f(d,h,a)}var b=a.$data===true&&this._opts.v5;if(b&&!a.validate){throw new Error('$data support: "validate" function is not defined')}var j=a.metaSchema;if(j){if(b){j={anyOf:[j,{"$ref":"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/json-schema-v5.json#/definitions/$data"}]}}a.validateSchema=this.compile(j,true)}}g.keywords[d]=g.all[d]=true;function f(n,m,q){var l;for(var p=0;p<g.length;p++){var o=g[p];if(o.type==m){l=o;break}}if(!l){l={type:m,rules:[]};g.push(l)}var r={keyword:n,definition:q,custom:true,code:customRuleCode};l.rules.push(r);g.custom[n]=r}function k(i){if(!g.types[i]){throw new Error("Unknown type "+i)}}}function getKeyword(a){var b=this.RULES.custom[a];return b?b.definition:this.RULES.keywords[a]||false}function removeKeyword(a){var e=this.RULES;delete e.keywords[a];delete e.all[a];delete e.custom[a];for(var c=0;c<e.length;c++){var d=e[c].rules;for(var b=0;b<d.length;b++){if(d[b].keyword==a){d.splice(b,1);break}}}};