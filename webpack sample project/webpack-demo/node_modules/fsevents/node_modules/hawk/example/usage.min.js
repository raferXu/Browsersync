var Http=require("http");var Request=require("request");var Hawk=require("../lib");var internals={credentials:{dh37fgj492je:{id:"dh37fgj492je",key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"sha256",user:"Steve"}}};var credentialsFunc=function(b,a){return a(null,internals.credentials[b])};var handler=function(b,a){Hawk.server.authenticate(b,credentialsFunc,{},function(e,d,c){var f=(!e?"Hello "+d.user+" "+c.ext:"Shoosh!");var g={"Content-Type":"text/plain","Server-Authorization":Hawk.server.header(d,c,{payload:f,contentType:"text/plain"})};a.writeHead(!e?200:401,g);a.end(f)})};Http.createServer(handler).listen(8000,"127.0.0.1");Request("http://127.0.0.1:8000/resource/1?b=1&a=2",function(c,b,a){console.log(b.statusCode+": "+a)});credentialsFunc("dh37fgj492je",function(c,b){var d=Hawk.client.header("http://127.0.0.1:8000/resource/1?b=1&a=2","GET",{credentials:b,ext:"and welcome!"});var a={uri:"http://127.0.0.1:8000/resource/1?b=1&a=2",method:"GET",headers:{authorization:d.field}};Request(a,function(g,f,e){var h=Hawk.client.authenticate(f,b,d.artifacts,{payload:e});console.log(f.statusCode+": "+e+(h?" (valid)":" (invalid)"));process.exit(0)})});