var Code=require("code");var Hawk=require("../lib");var Hoek=require("hoek");var Lab=require("lab");var internals={};var lab=exports.lab=Lab.script();var describe=lab.experiment;var it=lab.test;var expect=Code.expect;describe("README",function(){describe("core",function(){var c={id:"dh37fgj492je",key:"werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn",algorithm:"sha256"};var b={credentials:c,timestamp:1353832234,nonce:"j4h3g2",ext:"some-app-ext-data"};it("should generate a header protocol example",function(d){var e=Hawk.client.header("http://example.com:8000/resource/1?b=1&a=2","GET",b).field;expect(e).to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", ext="some-app-ext-data", mac="6R4rV5iE+NPoym+WwjeHzjAGXUtLNIxmo1vpMofpLAE="');d()});it("should generate a normalized string protocol example",function(d){var e=Hawk.crypto.generateNormalizedString("header",{credentials:c,ts:b.timestamp,nonce:b.nonce,method:"GET",resource:"/resource?a=1&b=2",host:"example.com",port:8000,ext:b.ext});expect(e).to.equal("hawk.1.header\n1353832234\nj4h3g2\nGET\n/resource?a=1&b=2\nexample.com\n8000\n\nsome-app-ext-data\n");d()});var a=Hoek.clone(b);a.payload="Thank you for flying Hawk";a.contentType="text/plain";it("should generate a header protocol example (with payload)",function(d){var e=Hawk.client.header("http://example.com:8000/resource/1?b=1&a=2","POST",a).field;expect(e).to.equal('Hawk id="dh37fgj492je", ts="1353832234", nonce="j4h3g2", hash="Yi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=", ext="some-app-ext-data", mac="aSe1DERmZuRl3pI36/9BdZmnErTw3sNzOOAUlfeKjVw="');d()});it("should generate a normalized string protocol example (with payload)",function(d){var e=Hawk.crypto.generateNormalizedString("header",{credentials:c,ts:b.timestamp,nonce:b.nonce,method:"POST",resource:"/resource?a=1&b=2",host:"example.com",port:8000,hash:Hawk.crypto.calculatePayloadHash(a.payload,c.algorithm,a.contentType),ext:b.ext});expect(e).to.equal("hawk.1.header\n1353832234\nj4h3g2\nPOST\n/resource?a=1&b=2\nexample.com\n8000\nYi9LfIIFRtBEPt74PVmbTF/xVAwPn7ub15ePICfgnuY=\nsome-app-ext-data\n");d()})})});