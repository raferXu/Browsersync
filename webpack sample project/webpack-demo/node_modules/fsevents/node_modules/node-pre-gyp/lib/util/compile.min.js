"use strict";module.exports=exports;var fs=require("fs");var path=require("path");var win=process.platform=="win32";var existsSync=fs.existsSync||path.existsSync;var cp=require("child_process");function which_node_gyp(){var e;if(process.env.npm_config_node_gyp){try{e=process.env.npm_config_node_gyp;if(existsSync(e)){return e}}catch(c){}}try{var a=require.resolve("node-gyp");e=path.join(path.dirname(path.dirname(a)),"bin/node-gyp.js");if(existsSync(e)){return e}}catch(c){}if(process.execPath.indexOf("iojs")===-1){try{var b=require.resolve("npm");e=path.join(path.dirname(path.dirname(b)),"node_modules/node-gyp/bin/node-gyp.js");if(existsSync(e)){return e}}catch(c){}}var d=path.join(path.dirname(path.dirname(process.execPath)),"lib/node_modules/npm/");e=path.join(d,"node_modules/node-gyp/bin/node-gyp.js");if(existsSync(e)){return e}}module.exports.run_gyp=function(b,c,h){var a="";var g=[];if(c.runtime&&c.runtime=="node-webkit"){a="nw-gyp";if(win){a+=".cmd"}}else{var f=which_node_gyp();if(f){a=process.execPath;g.push(f)}else{a="node-gyp";if(win){a+=".cmd"}}}var e=g.concat(b);var d=cp.spawn(a,e,{cwd:undefined,env:process.env,stdio:[0,1,2]});d.on("error",function(i){if(i){return h(new Error("Failed to execute '"+a+" "+e.join(" ")+"' ("+i+")"))}h(null,c)});d.on("close",function(i){if(i&&i!==0){return h(new Error("Failed to execute '"+a+" "+e.join(" ")+"' ("+i+")"))}h(null,c)})};