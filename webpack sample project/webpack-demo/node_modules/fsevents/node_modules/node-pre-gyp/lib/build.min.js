"use strict";module.exports=exports=build;exports.usage="Attempts to compile the module by dispatching to node-gyp or nw-gyp";var compile=require("./util/compile.js");var handle_gyp_opts=require("./util/handle_gyp_opts.js");var configure=require("./configure.js");function do_build(b,a,c){handle_gyp_opts(b,a,function(e,d){var f=["build"].concat(d.gyp).concat(d.pre);if(d.unparsed.length>0){f=f.concat(["--"]).concat(d.unparsed)}compile.run_gyp(f,d.opts,function(g){return c(g)})})}function build(b,a,c){if(a.length&&(a.indexOf("rebuild")>-1)){compile.run_gyp(["clean"],{},function(d){if(d){return c(d)}configure(b,a,function(e){if(e){return c(e)}return do_build(b,a,c)})})}else{return do_build(b,a,c)}};