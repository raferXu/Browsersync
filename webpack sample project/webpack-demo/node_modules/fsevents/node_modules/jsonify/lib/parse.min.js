var at,ch,escapee={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},text,error=function(a){throw {name:"SyntaxError",message:a,at:at,text:text}},next=function(a){if(a&&a!==ch){error("Expected '"+a+"' instead of '"+ch+"'")}ch=text.charAt(at);at+=1;return ch},number=function(){var b,a="";if(ch==="-"){a="-";next("-")}while(ch>="0"&&ch<="9"){a+=ch;next()}if(ch==="."){a+=".";while(next()&&ch>="0"&&ch<="9"){a+=ch}}if(ch==="e"||ch==="E"){a+=ch;next();if(ch==="-"||ch==="+"){a+=ch;next()}while(ch>="0"&&ch<="9"){a+=ch;next()}}b=+a;if(!isFinite(b)){error("Bad number")}else{return b}},string=function(){var d,c,b="",a;if(ch==='"'){while(next()){if(ch==='"'){next();return b}else{if(ch==="\\"){next();if(ch==="u"){a=0;for(c=0;c<4;c+=1){d=parseInt(next(),16);if(!isFinite(d)){break}a=a*16+d}b+=String.fromCharCode(a)}else{if(typeof escapee[ch]==="string"){b+=escapee[ch]}else{break}}}else{b+=ch}}}}error("Bad string")},white=function(){while(ch&&ch<=" "){next()}},word=function(){switch(ch){case"t":next("t");next("r");next("u");next("e");return true;case"f":next("f");next("a");next("l");next("s");next("e");return false;case"n":next("n");next("u");next("l");next("l");return null}error("Unexpected '"+ch+"'")},value,array=function(){var a=[];if(ch==="["){next("[");white();if(ch==="]"){next("]");return a}while(ch){a.push(value());white();if(ch==="]"){next("]");return a}next(",");white()}}error("Bad array")},object=function(){var b,a={};if(ch==="{"){next("{");white();if(ch==="}"){next("}");return a}while(ch){b=string();white();next(":");if(Object.hasOwnProperty.call(a,b)){error('Duplicate key "'+b+'"')}a[b]=value();white();if(ch==="}"){next("}");return a}next(",");white()}}error("Bad object")};value=function(){white();switch(ch){case"{":return object();case"[":return array();case'"':return string();case"-":return number();default:return ch>="0"&&ch<="9"?number():word()}};module.exports=function(d,b){var a;text=d;at=0;ch=" ";a=value();white();if(ch){error("Syntax error")}return typeof b==="function"?(function c(h,g){var f,e,i=h[g];if(i&&typeof i==="object"){for(f in i){if(Object.prototype.hasOwnProperty.call(i,f)){e=c(i,f);if(e!==undefined){i[f]=e}else{delete i[f]}}}}return b.call(h,g,i)}({"":a},"")):a};