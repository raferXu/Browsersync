var Buffer=require("safe-buffer").Buffer;var MD5=require("md5.js");function EVP_BytesToKey(l,g,j,i){if(!Buffer.isBuffer(l)){l=Buffer.from(l,"binary")}if(g){if(!Buffer.isBuffer(g)){g=Buffer.from(g,"binary")}if(g.length!==8){throw new RangeError("salt should be Buffer with 8 byte length")}}var a=j/8;var k=Buffer.alloc(a);var d=Buffer.alloc(i||0);var f=Buffer.alloc(0);while(a>0||i>0){var e=new MD5();e.update(f);e.update(l);if(g){e.update(g)}f=e.digest();var m=0;if(a>0){var h=k.length-a;m=Math.min(a,f.length);f.copy(k,h,0,m);a-=m}if(m<f.length&&i>0){var c=d.length-i;var b=Math.min(i,f.length-m);f.copy(d,c,m,m+b);i-=b}}f.fill(0);return{key:k,iv:d}}module.exports=EVP_BytesToKey;