"use strict";var util=require("util");var isArrayish=require("is-arrayish");var errorEx=function errorEx(a,b){if(!a||a.constructor!==String){b=a||{};a=Error.name}var d=function c(g){if(!this){return new c(g)}g=g instanceof Error?g.message:(g||this.message);Error.call(this,g);Error.captureStackTrace(this,d);this.name=a;Object.defineProperty(this,"message",{configurable:true,enumerable:false,get:function(){var j=g.split(/\r?\n/g);for(var k in b){if(!b.hasOwnProperty(k)){continue}var i=b[k];if("message" in i){j=i.message(this[k],j)||j;if(!isArrayish(j)){j=[j]}}}return j.join("\n")},set:function(i){g=i}});var h=Object.getOwnPropertyDescriptor(this,"stack");var f=h.get;var e=h.value;delete h.value;delete h.writable;h.get=function(){var j=(f)?f.call(this).split(/\r?\n+/g):e.split(/\r?\n+/g);j[0]=this.name+": "+this.message;var l=1;for(var m in b){if(!b.hasOwnProperty(m)){continue}var i=b[m];if("line" in i){var k=i.line(this[m]);if(k){j.splice(l++,0,"    "+k)}}if("stack" in i){i.stack(this[m],j)}}return j.join("\n")};Object.defineProperty(this,"stack",h)};if(Object.setPrototypeOf){Object.setPrototypeOf(d.prototype,Error.prototype);Object.setPrototypeOf(d,Error)}else{util.inherits(d,Error)}return d};errorEx.append=function(b,a){return{message:function(c,d){c=c||a;if(c){d[0]+=" "+b.replace("%s",c.toString())}return d}}};errorEx.line=function(b,a){return{line:function(c){c=c||a;if(c){return b.replace("%s",c.toString())}return null}}};module.exports=errorEx;