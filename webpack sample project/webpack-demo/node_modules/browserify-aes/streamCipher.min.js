var aes=require("./aes");var Buffer=require("safe-buffer").Buffer;var Transform=require("cipher-base");var inherits=require("inherits");function StreamCipher(d,c,b,a){Transform.call(this);this._cipher=new aes.AES(c);this._prev=Buffer.from(b);this._cache=Buffer.allocUnsafe(0);this._secCache=Buffer.allocUnsafe(0);this._decrypt=a;this._mode=d}inherits(StreamCipher,Transform);StreamCipher.prototype._update=function(a){return this._mode.encrypt(this,a,this._decrypt)};StreamCipher.prototype._final=function(){this._cipher.scrub()};module.exports=StreamCipher;