var xor=require("buffer-xor");function getBlock(a){a._prev=a._cipher.encryptBlock(a._prev);return a._prev}exports.encrypt=function(a,b){while(a._cache.length<b.length){a._cache=Buffer.concat([a._cache,getBlock(a)])}var c=a._cache.slice(0,b.length);a._cache=a._cache.slice(b.length);return xor(b,c)};