var Buffer=require("safe-buffer").Buffer;function encryptByte(j,g,a){var b;var d=-1;var e=8;var c=0;var f,h;while(++d<e){b=j._cipher.encryptBlock(j._prev);f=(g&(1<<(7-d)))?128:0;h=b[0]^f;c+=((h&128)>>(d%8));j._prev=shiftIn(j._prev,a?f:h)}return c}function shiftIn(b,e){var a=b.length;var d=-1;var c=Buffer.allocUnsafe(b.length);b=Buffer.concat([b,Buffer.from([e])]);while(++d<a){c[d]=b[d]<<1|b[d+1]>>(7)}return c}exports.encrypt=function(b,e,d){var a=e.length;var c=Buffer.allocUnsafe(a);var f=-1;while(++f<a){c[f]=encryptByte(b,e[f],d)}return c};