var xor=require("buffer-xor");function incr32(b){var a=b.length;var c;while(a--){c=b.readUInt8(a);if(c===255){b.writeUInt8(0,a)}else{c++;b.writeUInt8(c,a);break}}}function getBlock(a){var b=a._cipher.encryptBlockRaw(a._prev);incr32(a._prev);return b}var blockSize=16;exports.encrypt=function(a,c){var e=Math.ceil(c.length/blockSize);var h=a._cache.length;a._cache=Buffer.concat([a._cache,Buffer.allocUnsafe(e*blockSize)]);for(var d=0;d<e;d++){var b=getBlock(a);var g=h+d*blockSize;a._cache.writeUInt32BE(b[0],g+0);a._cache.writeUInt32BE(b[1],g+4);a._cache.writeUInt32BE(b[2],g+8);a._cache.writeUInt32BE(b[3],g+12)}var f=a._cache.slice(0,c.length);a._cache=a._cache.slice(c.length);return xor(c,f)};