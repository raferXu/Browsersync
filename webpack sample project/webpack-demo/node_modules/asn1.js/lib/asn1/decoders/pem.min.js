var inherits=require("inherits");var Buffer=require("buffer").Buffer;var DERDecoder=require("./der");function PEMDecoder(a){DERDecoder.call(this,a);this.enc="pem"}inherits(PEMDecoder,DERDecoder);module.exports=PEMDecoder;PEMDecoder.prototype.decode=function decode(c,k){var l=c.toString().split(/[\r\n]+/g);var h=k.label.toUpperCase();var j=/^-----(BEGIN|END) ([^-]+)-----$/;var a=-1;var b=-1;for(var d=0;d<l.length;d++){var e=l[d].match(j);if(e===null){continue}if(e[2]!==h){continue}if(a===-1){if(e[1]!=="BEGIN"){break}a=d}else{if(e[1]!=="END"){break}b=d;break}}if(a===-1||b===-1){throw new Error("PEM section not found for: "+h)}var f=l.slice(a+1,b).join("");f.replace(/[^a-z0-9\+\/=]+/gi,"");var g=new Buffer(f,"base64");return DERDecoder.prototype.decode.call(this,g,k)};