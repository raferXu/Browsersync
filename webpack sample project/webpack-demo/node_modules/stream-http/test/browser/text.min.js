var Buffer=require("buffer").Buffer;var fs=require("fs");var test=require("tape");var UAParser=require("ua-parser-js");var url=require("url");var http=require("../..");var browser=(new UAParser()).setUA(navigator.userAgent).getBrowser();var browserName=browser.name;var browserVersion=browser.major;var skipResponseUrl=((browserName==="Opera")||(browserName==="IE")||(browserName==="Edge")||(browserName==="Chrome"&&browserVersion<=36)||(browserName==="Firefox"&&browserVersion<=31)||((browserName==="Safari"||browserName==="Mobile Safari")&&browserVersion<=8)||(browserName==="WebKit")||(browserName==="Android Browser"&&browserVersion<=4));var reference=fs.readFileSync(__dirname+"/../server/static/basic.txt");test("basic functionality",function(a){http.get("/basic.txt",function(c){if(!skipResponseUrl){var d=url.resolve(global.location.href,"/basic.txt");a.equals(c.url,d,"response url correct")}var b=[];c.on("end",function(){a.ok(reference.equals(Buffer.concat(b)),"contents match");a.end()});c.on("data",function(e){b.push(e)})})});