var randomBytes=require("randombytes");module.exports=findPrime;findPrime.simpleSieve=simpleSieve;findPrime.fermatTest=fermatTest;var BN=require("bn.js");var TWENTYFOUR=new BN(24);var MillerRabin=require("miller-rabin");var millerRabin=new MillerRabin();var ONE=new BN(1);var TWO=new BN(2);var FIVE=new BN(5);var SIXTEEN=new BN(16);var EIGHT=new BN(8);var TEN=new BN(10);var THREE=new BN(3);var SEVEN=new BN(7);var ELEVEN=new BN(11);var FOUR=new BN(4);var TWELVE=new BN(12);var primes=null;function _getPrimes(){if(primes!==null){return primes}var a=1048576;var e=[];e[0]=2;for(var d=1,b=3;b<a;b+=2){var f=Math.ceil(Math.sqrt(b));for(var c=0;c<d&&e[c]<=f;c++){if(b%e[c]===0){break}}if(d!==c&&e[c]<=f){continue}e[d++]=b}primes=e;return e}function simpleSieve(c){var b=_getPrimes();for(var a=0;a<b.length;a++){if(c.modn(b[a])===0){if(c.cmpn(b[a])===0){return true}else{return false}}}return true}function fermatTest(b){var a=BN.mont(b);return TWO.toRed(a).redPow(b.subn(1)).fromRed().cmpn(1)===0}function findPrime(c,d){if(c<16){if(d===2||d===5){return new BN([140,123])}else{return new BN([140,39])}}d=new BN(d);var a,b;while(true){a=new BN(randomBytes(Math.ceil(c/8)));while(a.bitLength()>c){a.ishrn(1)}if(a.isEven()){a.iadd(ONE)}if(!a.testn(1)){a.iadd(TWO)}if(!d.cmp(TWO)){while(a.mod(TWENTYFOUR).cmp(ELEVEN)){a.iadd(FOUR)}}else{if(!d.cmp(FIVE)){while(a.mod(TEN).cmp(THREE)){a.iadd(FOUR)}}}b=a.shrn(1);if(simpleSieve(b)&&simpleSieve(a)&&fermatTest(b)&&fermatTest(a)&&millerRabin.test(b)&&millerRabin.test(a)){return a}}};