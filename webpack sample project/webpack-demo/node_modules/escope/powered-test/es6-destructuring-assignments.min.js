(function(){var b,c,a;c=require("chai").expect;a=require("../third_party/esprima");b=require("..");describe("ES6 destructuring assignments",function(){it("Pattern in var in ForInStatement",function(){var d,e,f,g;d=a.parse("(function () {\n    for (var [a, b, c] in array);\n}());");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(0);c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("array");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(4);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("a");c(f.variables[2].name).to.be.equal("b");c(f.variables[3].name).to.be.equal("c");c(f.references).to.have.length(4);c(f.references[0].identifier.name).to.be.equal("a");c(f.references[0].isWrite()).to.be["true"];c(f.references[0].partial).to.be["true"];c(f.references[0].resolved).to.be.equal(f.variables[1]);c(f.references[1].identifier.name).to.be.equal("b");c(f.references[1].isWrite()).to.be["true"];c(f.references[1].partial).to.be["true"];c(f.references[1].resolved).to.be.equal(f.variables[2]);c(f.references[2].identifier.name).to.be.equal("c");c(f.references[2].isWrite()).to.be["true"];c(f.references[2].partial).to.be["true"];c(f.references[2].resolved).to.be.equal(f.variables[3]);c(f.references[3].identifier.name).to.be.equal("array");return c(f.references[3].isWrite()).to.be["false"]});it("ArrayPattern in var",function(){var d,e,f,g;d=a.parse("(function () {\n    var [a, b, c] = array;\n}());");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(0);c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("array");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(4);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("a");c(f.variables[2].name).to.be.equal("b");c(f.variables[3].name).to.be.equal("c");c(f.references).to.have.length(4);c(f.references[0].identifier.name).to.be.equal("a");c(f.references[0].isWrite()).to.be["true"];c(f.references[0].partial).to.be["true"];c(f.references[0].resolved).to.be.equal(f.variables[1]);c(f.references[1].identifier.name).to.be.equal("b");c(f.references[1].isWrite()).to.be["true"];c(f.references[1].partial).to.be["true"];c(f.references[1].resolved).to.be.equal(f.variables[2]);c(f.references[2].identifier.name).to.be.equal("c");c(f.references[2].isWrite()).to.be["true"];c(f.references[2].partial).to.be["true"];c(f.references[2].resolved).to.be.equal(f.variables[3]);c(f.references[3].identifier.name).to.be.equal("array");return c(f.references[3].isWrite()).to.be["false"]});it("SpreadElement in var",function(){var d,g,l,e,o,m,j,i,n,f,k,h;d=a.parse("(function () {\n    var [a, b, ...rest] = array;\n}());");m=b.analyze(d,{ecmaVersion:6});c(m.scopes).to.have.length(2);o=m.scopes[0];g=o;c(o.type).to.be.equal("global");c(o.variables).to.have.length(0);c(o.references).to.have.length(0);c(o.implicit.left).to.have.length(1);c(o.implicit.left[0].identifier.name).to.be.equal("array");o=m.scopes[1];c(o.type).to.be.equal("function");c(o.variables).to.have.length(4);c(o.variables[0].name).to.be.equal("arguments");c(o.variables[1].name).to.be.equal("a");c(o.variables[2].name).to.be.equal("b");c(o.variables[3].name).to.be.equal("rest");c(o.references).to.have.length(4);c(o.references[0].identifier.name).to.be.equal("a");c(o.references[0].isWrite()).to.be["true"];c(o.references[0].partial).to.be["true"];c(o.references[0].resolved).to.be.equal(o.variables[1]);c(o.references[1].identifier.name).to.be.equal("b");c(o.references[1].isWrite()).to.be["true"];c(o.references[1].partial).to.be["true"];c(o.references[1].resolved).to.be.equal(o.variables[2]);c(o.references[2].identifier.name).to.be.equal("rest");c(o.references[2].isWrite()).to.be["true"];c(o.references[2].partial).to.be["true"];c(o.references[2].resolved).to.be.equal(o.variables[3]);c(o.references[3].identifier.name).to.be.equal("array");c(o.references[3].isWrite()).to.be["false"];d=a.parse("(function () {\n    var [a, b, ...[c, d, ...rest]] = array;\n}());");m=b.analyze(d,{ecmaVersion:6});c(m.scopes).to.have.length(2);o=m.scopes[0];g=o;c(o.type).to.be.equal("global");c(o.variables).to.have.length(0);c(o.references).to.have.length(0);c(o.implicit.left).to.have.length(1);c(o.implicit.left[0].identifier.name).to.be.equal("array");o=m.scopes[1];c(o.type).to.be.equal("function");c(o.variables).to.have.length(6);k=["arguments","a","b","c","d","rest"];for(l=j=0,n=k.length;j<n;l=++j){e=k[l];c(o.variables[l].name).to.be.equal(e)}c(o.references).to.have.length(6);h=["a","b","c","d","rest"];for(l=i=0,f=h.length;i<f;l=++i){e=h[l];c(o.references[l].identifier.name).to.be.equal(e);c(o.references[l].isWrite()).to.be["true"];c(o.references[l].partial).to.be["true"]}c(o.references[5].identifier.name).to.be.equal("array");return c(o.references[5].isWrite()).to.be["false"]});it("ObjectPattern in var",function(){var d,e,f,g;d=a.parse("(function () {\n    var {\n        shorthand,\n        key: value,\n        hello: {\n            world\n        }\n    } = object;\n}());");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(0);c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("object");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(4);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("shorthand");c(f.variables[2].name).to.be.equal("value");c(f.variables[3].name).to.be.equal("world");c(f.references).to.have.length(4);c(f.references[0].identifier.name).to.be.equal("shorthand");c(f.references[0].isWrite()).to.be["true"];c(f.references[0].partial).to.be["true"];c(f.references[0].resolved).to.be.equal(f.variables[1]);c(f.references[1].identifier.name).to.be.equal("value");c(f.references[1].isWrite()).to.be["true"];c(f.references[1].partial).to.be["true"];c(f.references[1].resolved).to.be.equal(f.variables[2]);c(f.references[2].identifier.name).to.be.equal("world");c(f.references[2].isWrite()).to.be["true"];c(f.references[2].partial).to.be["true"];c(f.references[2].resolved).to.be.equal(f.variables[3]);c(f.references[3].identifier.name).to.be.equal("object");return c(f.references[3].isWrite()).to.be["false"]});it("complex pattern in var",function(){var d,g,l,e,o,m,j,i,n,f,k,h;d=a.parse("(function () {\n    var {\n        shorthand,\n        key: [ a, b, c, d, e ],\n        hello: {\n            world\n        }\n    } = object;\n}());");m=b.analyze(d,{ecmaVersion:6});c(m.scopes).to.have.length(2);o=m.scopes[0];g=o;c(o.type).to.be.equal("global");c(o.variables).to.have.length(0);c(o.references).to.have.length(0);c(o.implicit.left).to.have.length(1);c(o.implicit.left[0].identifier.name).to.be.equal("object");o=m.scopes[1];c(o.type).to.be.equal("function");c(o.variables).to.have.length(8);k=["arguments","shorthand","a","b","c","d","e","world"];for(l=j=0,n=k.length;j<n;l=++j){e=k[l];c(o.variables[l].name).to.be.equal(e)}c(o.references).to.have.length(8);h=["shorthand","a","b","c","d","e","world"];for(l=i=0,f=h.length;i<f;l=++i){e=h[l];c(o.references[l].identifier.name).to.be.equal(e);c(o.references[l].isWrite()).to.be["true"];c(o.references[l].partial).to.be["true"]}c(o.references[7].identifier.name).to.be.equal("object");return c(o.references[7].isWrite()).to.be["false"]});it("ArrayPattern in AssignmentExpression",function(){var d,e,f,g;d=a.parse("(function () {\n    [a, b, c] = array;\n}());");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(0);c(f.implicit.left).to.have.length(4);c(f.implicit.left.map((function(h){return function(i){return i.identifier.name}})(this))).to.deep.equal(["a","b","c","array"]);f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(1);c(f.variables[0].name).to.be.equal("arguments");c(f.references).to.have.length(4);c(f.references[0].identifier.name).to.be.equal("a");c(f.references[0].isWrite()).to.be["true"];c(f.references[0].partial).to.be["true"];c(f.references[0].resolved).to.be["null"];c(f.references[1].identifier.name).to.be.equal("b");c(f.references[1].isWrite()).to.be["true"];c(f.references[1].partial).to.be["true"];c(f.references[1].resolved).to.be["null"];c(f.references[2].identifier.name).to.be.equal("c");c(f.references[2].isWrite()).to.be["true"];c(f.references[2].partial).to.be["true"];c(f.references[2].resolved).to.be["null"];c(f.references[3].identifier.name).to.be.equal("array");return c(f.references[3].isWrite()).to.be["false"]});it("SpreadElement in AssignmentExpression",function(){var d,f,i,e,l,j,g,k,h;d=a.parse("(function () {\n    [a, b, ...rest] = array;\n}());");j=b.analyze(d,{ecmaVersion:6});c(j.scopes).to.have.length(2);l=j.scopes[0];f=l;c(l.type).to.be.equal("global");c(l.variables).to.have.length(0);c(l.references).to.have.length(0);c(l.implicit.left).to.have.length(4);c(l.implicit.left.map((function(m){return function(n){return n.identifier.name}})(this))).to.deep.equal(["a","b","rest","array"]);l=j.scopes[1];c(l.type).to.be.equal("function");c(l.variables).to.have.length(1);c(l.variables[0].name).to.be.equal("arguments");c(l.references).to.have.length(4);c(l.references[0].identifier.name).to.be.equal("a");c(l.references[0].isWrite()).to.be["true"];c(l.references[0].partial).to.be["true"];c(l.references[0].resolved).to.be["null"];c(l.references[1].identifier.name).to.be.equal("b");c(l.references[1].isWrite()).to.be["true"];c(l.references[1].partial).to.be["true"];c(l.references[1].resolved).to.be["null"];c(l.references[2].identifier.name).to.be.equal("rest");c(l.references[2].isWrite()).to.be["true"];c(l.references[2].partial).to.be["true"];c(l.references[2].resolved).to.be["null"];c(l.references[3].identifier.name).to.be.equal("array");c(l.references[3].isWrite()).to.be["false"];d=a.parse("(function () {\n    [a, b, ...[c, d, ...rest]] = array;\n}());");j=b.analyze(d,{ecmaVersion:6});c(j.scopes).to.have.length(2);l=j.scopes[0];f=l;c(l.type).to.be.equal("global");c(l.variables).to.have.length(0);c(l.references).to.have.length(0);c(l.implicit.left).to.have.length(6);c(l.implicit.left.map((function(m){return function(n){return n.identifier.name}})(this))).to.deep.equal(["a","b","c","d","rest","array"]);l=j.scopes[1];c(l.type).to.be.equal("function");c(l.variables).to.have.length(1);c(l.variables[0].name).to.be.equal("arguments");c(l.references).to.have.length(6);h=["a","b","c","d","rest"];for(i=g=0,k=h.length;g<k;i=++g){e=h[i];c(l.references[i].identifier.name).to.be.equal(e);c(l.references[i].isWrite()).to.be["true"];c(l.references[i].partial).to.be["true"];c(l.references[i].resolved).to.be["null"]}c(l.references[5].identifier.name).to.be.equal("array");return c(l.references[5].isWrite()).to.be["false"]});it("ObjectPattern in AssignmentExpression",function(){var d,e,f,g;d=a.parse("(function () {\n    ({\n        shorthand,\n        key: value,\n        hello: {\n            world\n        }\n    }) = object;\n}());");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(0);c(f.implicit.left).to.have.length(4);c(f.implicit.left.map((function(h){return function(i){return i.identifier.name}})(this))).to.deep.equal(["shorthand","value","world","object"]);f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(1);c(f.variables[0].name).to.be.equal("arguments");c(f.references).to.have.length(4);c(f.references[0].identifier.name).to.be.equal("shorthand");c(f.references[0].isWrite()).to.be["true"];c(f.references[0].partial).to.be["true"];c(f.references[0].resolved).to["null"];c(f.references[1].identifier.name).to.be.equal("value");c(f.references[1].isWrite()).to.be["true"];c(f.references[1].partial).to.be["true"];c(f.references[1].resolved).to["null"];c(f.references[2].identifier.name).to.be.equal("world");c(f.references[2].isWrite()).to.be["true"];c(f.references[2].partial).to.be["true"];c(f.references[2].resolved).to["null"];c(f.references[3].identifier.name).to.be.equal("object");return c(f.references[3].isWrite()).to.be["false"]});it("complex pattern in AssignmentExpression",function(){var d,f,i,e,l,j,g,k,h;d=a.parse("(function () {\n    ({\n        shorthand,\n        key: [ a, b, c, d, e ],\n        hello: {\n            world\n        }\n    }) = object;\n}());");j=b.analyze(d,{ecmaVersion:6});c(j.scopes).to.have.length(2);l=j.scopes[0];f=l;c(l.type).to.be.equal("global");c(l.variables).to.have.length(0);c(l.references).to.have.length(0);c(l.implicit.left).to.have.length(8);c(l.implicit.left.map((function(m){return function(n){return n.identifier.name}})(this))).to.deep.equal(["shorthand","a","b","c","d","e","world","object"]);l=j.scopes[1];c(l.type).to.be.equal("function");c(l.variables).to.have.length(1);c(l.variables[0].name).to.be.equal("arguments");c(l.references).to.have.length(8);h=["shorthand","a","b","c","d","e","world"];for(i=g=0,k=h.length;g<k;i=++g){e=h[i];c(l.references[i].identifier.name).to.be.equal(e);c(l.references[i].isWrite()).to.be["true"];c(l.references[i].partial).to.be["true"]}c(l.references[7].identifier.name).to.be.equal("object");return c(l.references[7].isWrite()).to.be["false"]});it("ArrayPattern in parameters",function(){var d,e,f,g;d=a.parse("(function ([a, b, c]) {\n}(array));");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(1);c(f.references[0].identifier.name).to.be.equal("array");c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("array");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(4);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("a");c(f.variables[2].name).to.be.equal("b");c(f.variables[3].name).to.be.equal("c");return c(f.references).to.have.length(0)});it("SpreadElement in parameters",function(){var d,e,f,g;d=a.parse("(function ([a, b, ...rest], ...rest2) {\n}(array));");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(1);c(f.references[0].identifier.name).to.be.equal("array");c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("array");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(5);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("a");c(f.variables[2].name).to.be.equal("b");c(f.variables[3].name).to.be.equal("rest");c(f.variables[3].defs[0].rest).to.be["false"];c(f.variables[4].name).to.be.equal("rest2");c(f.variables[4].defs[0].rest).to.be["true"];return c(f.references).to.have.length(0)});it("ObjectPattern in parameters",function(){var d,e,f,g;d=a.parse("(function ({\n        shorthand,\n        key: value,\n        hello: {\n            world\n        }\n    }) {\n}(object));");g=b.analyze(d,{ecmaVersion:6});c(g.scopes).to.have.length(2);f=g.scopes[0];e=f;c(f.type).to.be.equal("global");c(f.variables).to.have.length(0);c(f.references).to.have.length(1);c(f.references[0].identifier.name).to.be.equal("object");c(f.implicit.left).to.have.length(1);c(f.implicit.left[0].identifier.name).to.be.equal("object");f=g.scopes[1];c(f.type).to.be.equal("function");c(f.variables).to.have.length(4);c(f.variables[0].name).to.be.equal("arguments");c(f.variables[1].name).to.be.equal("shorthand");c(f.variables[2].name).to.be.equal("value");c(f.variables[3].name).to.be.equal("world");return c(f.references).to.have.length(0)});return it("complex pattern in parameters",function(){var d,f,i,e,l,j,g,k,h;d=a.parse("(function ({\n        shorthand,\n        key: [ a, b, c, d, e ],\n        hello: {\n            world\n        }\n    }) {\n}(object));");j=b.analyze(d,{ecmaVersion:6});c(j.scopes).to.have.length(2);l=j.scopes[0];f=l;c(l.type).to.be.equal("global");c(l.variables).to.have.length(0);c(l.references).to.have.length(1);c(l.references[0].identifier.name).to.be.equal("object");c(l.implicit.left).to.have.length(1);c(l.implicit.left[0].identifier.name).to.be.equal("object");l=j.scopes[1];c(l.type).to.be.equal("function");c(l.variables).to.have.length(8);h=["arguments","shorthand","a","b","c","d","e","world"];for(i=g=0,k=h.length;g<k;i=++g){e=h[i];c(l.variables[i].name).to.be.equal(e)}return c(l.references).to.have.length(0)})})}).call(this);