(function(){var b,c,a;c=require("chai").expect;a=require("../third_party/esprima");b=require("..");describe("ES6 class",function(){it("declaration name creates class scope",function(){var d,e,f;d=a.parse("class Derived extends Base {\n    constructor() {\n    }\n}\nnew Derived();");f=b.analyze(d,{ecmaVersion:6});c(f.scopes).to.have.length(3);e=f.scopes[0];c(e.type).to.be.equal("global");c(e.block.type).to.be.equal("Program");c(e.isStrict).to.be["false"];c(e.variables).to.have.length(1);c(e.variables[0].name).to.be.equal("Derived");c(e.references).to.have.length(2);c(e.references[0].identifier.name).to.be.equal("Base");c(e.references[1].identifier.name).to.be.equal("Derived");e=f.scopes[1];c(e.type).to.be.equal("class");c(e.block.type).to.be.equal("ClassDeclaration");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(1);c(e.variables[0].name).to.be.equal("Derived");c(e.references).to.have.length(0);e=f.scopes[2];c(e.type).to.be.equal("function");c(e.block.type).to.be.equal("FunctionExpression");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(1);c(e.variables[0].name).to.be.equal("arguments");return c(e.references).to.have.length(0)});it("declaration name creates class scope",function(){var d,e,f;d=a.parse("class Base {\n    constructor() {\n    }\n}\nlet foo = new Base();");f=b.analyze(d,{ecmaVersion:6});c(f.scopes).to.have.length(3);e=f.scopes[0];c(e.type).to.be.equal("global");c(e.block.type).to.be.equal("Program");c(e.isStrict).to.be["false"];c(e.variables).to.have.length(2);c(e.variables[0].name).to.be.equal("Base");c(e.variables[1].name).to.be.equal("foo");c(e.through).to.have.length(0);c(e.references).to.have.length(2);c(e.references[0].identifier.name).to.be.equal("foo");c(e.references[1].identifier.name).to.be.equal("Base");e=f.scopes[1];c(e.type).to.be.equal("class");c(e.block.type).to.be.equal("ClassDeclaration");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(1);console.dir(e.variables);c(e.variables[0].name).to.be.equal("Base");c(e.references).to.have.length(0);e=f.scopes[2];c(e.type).to.be.equal("function");c(e.block.type).to.be.equal("FunctionExpression");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(1);c(e.variables[0].name).to.be.equal("arguments");return c(e.references).to.have.length(0)});it("expression name creates class scope#1",function(){var d,e,f;d=a.parse("(class Derived extends Base {\n    constructor() {\n    }\n});");f=b.analyze(d,{ecmaVersion:6});c(f.scopes).to.have.length(3);e=f.scopes[0];c(e.type).to.be.equal("global");c(e.block.type).to.be.equal("Program");c(e.isStrict).to.be["false"];c(e.variables).to.have.length(0);c(e.references).to.have.length(1);c(e.references[0].identifier.name).to.be.equal("Base");e=f.scopes[1];c(e.type).to.be.equal("class");c(e.block.type).to.be.equal("ClassExpression");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(1);c(e.variables[0].name).to.be.equal("Derived");c(e.references).to.have.length(0);e=f.scopes[2];c(e.type).to.be.equal("function");return c(e.block.type).to.be.equal("FunctionExpression")});it("expression name creates class scope#2",function(){var d,e,f;d=a.parse("(class extends Base {\n    constructor() {\n    }\n});");f=b.analyze(d,{ecmaVersion:6});c(f.scopes).to.have.length(3);e=f.scopes[0];c(e.type).to.be.equal("global");c(e.block.type).to.be.equal("Program");c(e.isStrict).to.be["false"];c(e.variables).to.have.length(0);c(e.references).to.have.length(1);c(e.references[0].identifier.name).to.be.equal("Base");e=f.scopes[1];c(e.type).to.be.equal("class");c(e.block.type).to.be.equal("ClassExpression");e=f.scopes[2];c(e.type).to.be.equal("function");return c(e.block.type).to.be.equal("FunctionExpression")});return it("computed property key may refer variables",function(){var d,e,f;d=a.parse("(function () {\n    var yuyushiki = 42;\n    (class {\n        [yuyushiki]() {\n        }\n\n        [yuyushiki + 40]() {\n        }\n    });\n}());");f=b.analyze(d,{ecmaVersion:6});c(f.scopes).to.have.length(5);e=f.scopes[0];c(e.type).to.be.equal("global");c(e.block.type).to.be.equal("Program");c(e.isStrict).to.be["false"];e=f.scopes[1];c(e.type).to.be.equal("function");c(e.block.type).to.be.equal("FunctionExpression");c(e.isStrict).to.be["false"];c(e.variables).to.have.length(2);c(e.variables[0].name).to.be.equal("arguments");c(e.variables[1].name).to.be.equal("yuyushiki");c(e.references).to.have.length(1);c(e.references[0].identifier.name).to.be.equal("yuyushiki");e=f.scopes[2];c(e.type).to.be.equal("class");c(e.block.type).to.be.equal("ClassExpression");c(e.isStrict).to.be["true"];c(e.variables).to.have.length(0);c(e.references).to.have.length(2);c(e.references[0].identifier.name).to.be.equal("yuyushiki");return c(e.references[1].identifier.name).to.be.equal("yuyushiki")})})}).call(this);