"use strict";var assert=require("minimalistic-assert");var inherits=require("inherits");var des=require("../des");var Cipher=des.Cipher;var DES=des.DES;function EDEState(b,a){assert.equal(a.length,24,"Invalid key length");var e=a.slice(0,8);var d=a.slice(8,16);var c=a.slice(16,24);if(b==="encrypt"){this.ciphers=[DES.create({type:"encrypt",key:e}),DES.create({type:"decrypt",key:d}),DES.create({type:"encrypt",key:c})]}else{this.ciphers=[DES.create({type:"decrypt",key:c}),DES.create({type:"encrypt",key:d}),DES.create({type:"decrypt",key:e})]}}function EDE(a){Cipher.call(this,a);var b=new EDEState(this.type,this.options.key);this._edeState=b}inherits(EDE,Cipher);module.exports=EDE;EDE.create=function create(a){return new EDE(a)};EDE.prototype._update=function _update(b,e,a,d){var c=this._edeState;c.ciphers[0]._update(b,e,a,d);c.ciphers[1]._update(a,d,a,d);c.ciphers[2]._update(a,d,a,d)};EDE.prototype._pad=DES.prototype._pad;EDE.prototype._unpad=DES.prototype._unpad;