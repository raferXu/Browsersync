"use strict";var si=require("set-immediate-shim");var stream=require("readable-stream");var util=require("util");var Readable=stream.Readable;module.exports=ReaddirpReadable;util.inherits(ReaddirpReadable,Readable);function ReaddirpReadable(a){if(!(this instanceof ReaddirpReadable)){return new ReaddirpReadable(a)}a=a||{};a.objectMode=true;Readable.call(this,a);this.highWaterMark=Infinity;this._destroyed=false;this._paused=false;this._warnings=[];this._errors=[];this._pauseResumeErrors()}var proto=ReaddirpReadable.prototype;proto._pauseResumeErrors=function(){var a=this;a.on("pause",function(){a._paused=true});a.on("resume",function(){if(a._destroyed){return}a._paused=false;a._warnings.forEach(function(b){a.emit("warn",b)});a._warnings.length=0;a._errors.forEach(function(b){a.emit("error",b)});a._errors.length=0})};proto._processEntry=function(a){if(this._destroyed){return}this.push(a)};proto._read=function(){};proto.destroy=function(){this.push(null);this.readable=false;this._destroyed=true;this.emit("close")};proto._done=function(){this.push(null)};proto._handleError=function(b){var a=this;si(function(){if(a._paused){return a._warnings.push(b)}if(!a._destroyed){a.emit("warn",b)}})};proto._handleFatalError=function(b){var a=this;si(function(){if(a._paused){return a._errors.push(b)}if(!a._destroyed){a.emit("error",b)}})};function createStreamAPI(){var a=new ReaddirpReadable();return{stream:a,processEntry:a._processEntry.bind(a),done:a._done.bind(a),handleError:a._handleError.bind(a),handleFatalError:a._handleFatalError.bind(a)}}module.exports=createStreamAPI;