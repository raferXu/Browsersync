var sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};var createHmac=require("create-hmac");var checkParameters=require("../lib/precondition");var defaultEncoding=require("../lib/default-encoding");var Buffer=require("safe-buffer").Buffer;function pbkdf2(r,o,c,a,p){if(!Buffer.isBuffer(r)){r=Buffer.from(r,defaultEncoding)}if(!Buffer.isBuffer(o)){o=Buffer.from(o,defaultEncoding)}checkParameters(c,a);p=p||"sha1";var b=Buffer.allocUnsafe(a);var s=Buffer.allocUnsafe(o.length+4);o.copy(s,0,0,o.length);var q=0;var n=sizes[p];var e=Math.ceil(a/n);for(var m=1;m<=e;m++){s.writeUInt32BE(m,o.length);var g=createHmac(p,r).update(s).digest();var d=g;for(var h=1;h<c;h++){d=createHmac(p,r).update(d).digest();for(var f=0;f<n;f++){g[f]^=d[f]}}g.copy(b,q);q+=n}return b}module.exports=pbkdf2;