var Fei=window.Fei={version:"1.0.0"};(function(){var b={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},f=(function(){div=document.createElement("div");div.setAttribute("class","t");return div.className==="t"})(),a=Object.prototype,e=a.toString,d=["valueOf","toLocaleString","toString","constructor"];var c=Fei.utils={getScrollTop:function(g){g=g||document;return Math.max(g.documentElement.scrollTop,g.body.scrollTop)},getScrollLeft:function(g){g=g||document;return Math.max(g.documentElement.scrollLeft,g.body.scrollLeft)},getCoord:function(i){var k=0;var h=0;if(document.documentElement.getBoundingClientRect){var j=i.getBoundingClientRect();var g=i.ownerDocument;if(navigator.userAgent.indexOf("MSIE 6.0")>=0){k=j.top-2+c.getScrollTop(g);h=j.left-2+c.getScrollLeft(g)}else{k=j.top+c.getScrollTop(g);h=j.left+c.getScrollLeft(g)}}else{while(i.offsetParent){k+=i.offsetTop;h+=i.offsetLeft;i=i.offsetParent}}return{top:k,left:h}},setAttr:function(h,g,i){if(!h){return h}h.setAttribute(f?g:(b[g]||g),i);if(g==="style"){h.style.cssText=i}return h},getAttr:function(h,g){return h.getAttribute(f?g:(b[g]||g))},createElement:function(j,h){var i=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml",j):document.createElement(j);if(h){for(var g in h){c.setAttr(i,g,h[g])}}return i},removeChildren:function(j){var h=j.childNodes;for(var g=h.length-1;g>=0;g--){j.removeChild(h.item(g))}},getBrowserStyle:function(k,h){var g=["","-o-","-ms-","-moz-","-webkit-"],l="";for(var j=0;j<g.length;j++){l+=(g[j]+k+":"+h+";")}return l},addEvent:function(j,g,i,h){if(!j){return j}var k=function(){i.apply(h||this,arguments)};if(j.addEventListener){j.addEventListener(g,k,false)}else{if(j.attachEvent){j.attachEvent("on"+g,k)}else{j["on"+g]=k}}},getGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var h=Math.random()*16|0,g=i==="x"?h:(h&3|8);return g.toString(16)})},clone:function(o){if(o===null||o===undefined){return o}if(o.nodeType&&o.cloneNode){return o.cloneNode(true)}var n=e.call(o),m,h,g,p,l;if(n==="[object Date]"){return new Date(o.getTime())}if(n==="[object Array]"){m=o.length;p=[];while(m--){p[m]=c.clone(o[m])}}else{if(n==="[object Object]"&&o.constructor===Object){p={};for(l in o){p[l]=c.clone(o[l])}if(d){for(h=d.length;h--;){g=d[h];if(o.hasOwnProperty(g)){p[g]=o[g]}}}}}return p||o},isUseVml:(function(){var g=navigator.userAgent.toLowerCase(),h=(!!window.ActiveXObject||"ActiveXObject" in window),i=h&&g.indexOf("msie")>-1&&parseInt(g.match(/msie ([\d.]+)/)[1])===8,j=h&&g.indexOf("msie")>-1&&parseInt(g.match(/msie ([\d.]+)/)[1])<8;return function(k){return i||j}})()}})();(function(){var a=Fei.utils;if(a.isUseVml()){var b=Fei.ieRotate={rotate:function(d,e){if(!d){return d}if(this.length===0||typeof e=="undefined"){return}if(typeof e=="number"){e={angle:e}}var f;if(!d.Fei||!d.Fei.PhotoEffect){var c=a.clone(e);f=new Fei.PhotoEffect(d,c)._rootObj}else{d.Fei.PhotoEffect._handleRotation(e);f=d.Fei.PhotoEffect._rootObj}return f}};Fei.PhotoEffect=function(d,e){this._img=d;this._onLoadDelegate=[e];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Fei={PhotoEffect:this};d.parentNode.insertBefore(this._rootObj,d);if(d.complete){this._Loader()}else{var c=this;d.onload=function(){c._Loader.call(c)};d.onreadystatechange=function(){if(this.readyState=="complete"){c._Loader.call(c)}}}};Fei.PhotoEffect.prototype={_setupParameters:function(c){this._parameters=this._parameters||{};if(typeof this._angle!=="number"){this._angle=0}if(typeof c.angle==="number"){this._angle=c.angle}this._parameters.animateTo=(typeof c.animateTo==="number")?(c.animateTo):(this._angle);this._parameters.step=c.step||this._parameters.step||null;this._parameters.easing=c.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration=c.duration||this._parameters.duration||1000;this._parameters.callback=c.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=c.center||this._parameters.center||["50%","50%"];if(typeof this._parameters.center[0]=="string"){this._rotationCenterX=(parseInt(this._parameters.center[0],10)/100)*this._imgWidth*this._aspectW}else{this._rotationCenterX=this._parameters.center[0]}if(typeof this._parameters.center[1]=="string"){this._rotationCenterY=(parseInt(this._parameters.center[1],10)/100)*this._imgHeight*this._aspectH}else{this._rotationCenterY=this._parameters.center[1]}if(c.bind&&c.bind!=this._parameters.bind){this._BindEvents(c.bind)}},_emptyFunction:function(){},_defaultEasing:function(f,g,e,i,h){return -i*((g=g/h-1)*g*g*g-1)+e},_handleRotation:function(c,d){this._setupParameters(c);if(this._angle==this._parameters.animateTo){this._rotate(this._angle)}else{this._animateStart()}},_BindEvents:function(d){if(d&&this._eventObj){if(this._parameters.bind){var c=this._parameters.bind}this._parameters.bind=d}},_Loader:(function(){return function(){var e=this._img.width;var c=this._img.height;var h=this._img.style.top;var g=this._img.style.left;var d=this._img.style.cursor;this._imgWidth=e;this._imgHeight=c;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height="100%";this._vimage.style.width="100%";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._vimage.setAttribute("id",this._img.getAttribute("id")+"_img");this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=e;this._container.style.height=c;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",e-1+","+(c-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=e+"px";this._rootObj.style.height=c+"px";this._rootObj.style.top=h;this._rootObj.style.left=g;this._rootObj.style.cursor=d;this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._eventObj=this._rootObj;var f;while(f=this._onLoadDelegate.shift()){this._handleRotation(f,true)}}})(),_animateStart:function(){if(this._timer){clearTimeout(this._timer)}this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var f=+new Date;var e=f-this._animateStartTime>this._parameters.duration;if(e&&!this._parameters.animatedGif){clearTimeout(this._timer)}else{if(this._canvas||this._vimage||this._img){var d=this._parameters.easing(0,f-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate((~~(d*10))/10)}if(this._parameters.step){this._parameters.step(this._angle)}var c=this;this._timer=setTimeout(function(){c._animate.call(c)},10)}if(this._parameters.callback&&e){this._angle=this._parameters.animateTo;this._rotate(this._angle);this._parameters.callback.call(this._rootObj)}},_rotate:(function(){var c=Math.PI/180;return function(d){this._angle=d;this._container.style.rotation=(d%360)+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}})(),createVMLNode:(function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml");return function(d){return document.createElement("<rvml:"+d+' class="rvml">')}}catch(c){return function(d){var e=document.createElement(d);e.setAttribute("class","rvml");e.setAttribute("className","rvml");e.setAttribute("xmlns","urn:schemas-microsoft.com:vml");return e}}})()}}})();(function(){var a=Fei.utils;var b=Fei.fImage=function(c){var e=this;e.isLoaded=false;e.src="";e.orgWidth=0;e.orgHeight=0;e.width=0;e.height=0;e.rotation=0;e.translateSpeed=300;e.translates={y:0,x:0};e.domId="fei_imgview_"+a.getGuid();e.dom=a.createElement("img",{id:e.domId});e.onload=function(){};if(c){for(var d in c){e[d]=c[d]}}e.orgTranslateSpeed=e.translateSpeed};b.prototype={init:function(){var c=this;if(c.src){c.setSrc(c.src)}if(c.dom.complete){c.imgLoad.call(c)}else{c.dom.onload=function(){c.imgLoad.call(c)};c.dom.onreadystatechange=function(){if(this.readyState=="complete"){c.imgLoad.call(c)}}}return c},imgLoad:function(){var d=this;if(d.isLoaded){return}d.isLoaded=true;try{var c=new Image();c.src=d.src;d.width=c.width;d.height=c.height;d.orgWidth=c.width;d.orgHeight=c.height;d.rotation=0;delete c}catch(f){}if(d.onload){d.onload.call(window,d)}},setSrc:function(d){var c=this;c.isLoaded=false;c.src=d||c.src;c.dom.src=c.src;if(c.dom.complete){c.imgLoad.call(c)}return c},doChange:function(){var f=this,c=document.getElementById(f.domId);if(!c){return}if(a.isUseVml()){c.style.left=f.translates.x+"px";c.style.top=f.translates.y+"px";if(!f.isMoveing){c.style.cursor="move";c.style.width=f.width+"px";c.style.height=f.height+"px";var g=c.children||c.childNodes;if(g.length>0){var e=g[0];e.style.width=f.width+"px";e.style.height=f.height+"px"}Fei.ieRotate.rotate(document.getElementById(f.domId),{animateTo:f.rotation,duration:f.translateSpeed})}}else{var d="cursor:move;width:"+f.width+"px;height:"+f.height+"px;";d+=a.getBrowserStyle("transform","translate("+f.translates.x+"px,"+f.translates.y+"px) rotate("+f.rotation+"deg)");if(f.translateSpeed>0){d+=a.getBrowserStyle("transition","all "+f.translateSpeed/1000+"s ease")}a.setAttr(c,"style",d)}return f},scale:function(d,c,k){var f=this,j=f.rotation%360,e=f.getAdSize(),i=0,c=c||0.5,k=k||0.5;if(j===90||j===270||j===-90||j===-270){i=(e.h-e.w)/2}var h=f.translates.x-(f.width-e.w)/2+i-(f.width*d-f.width)*c;var g=f.translates.y-(f.height-e.h)/2-i-(f.height*d-f.height)*k;f.width=f.width*d;f.height=f.height*d;f.transition(h,g);return f},transition:function(c,e){var d=this;d.translates.y=e;d.translates.x=c;return d},rotate:function(d){var c=this;c.rotation=c.rotation+d;return c},getAdSize:function(){var e=this,d=e.rotation%360,c=e.width,f=e.height;if(d===90||d===270||d===-90||d===-270){c=e.height;f=e.width}return{w:c,h:f}},setAdSize:function(c,e){var f=this,d=f.rotation%360;if(d===90||d===270||d===-90||d===-270){f.height=c;f.width=e}else{f.height=e;f.width=c}return f},getOrgSize:function(){var e=this,d=e.rotation%360,c=e.orgWidth,f=e.orgHeight;if(d===90||d===270||d===-90||d===-270){c=e.orgHeight;f=e.orgWidth}return{w:c,h:f}}}})();(function(){var a=Fei.utils;var b=Fei.fImagePanel=function(c){var e=this;e.width=0;e.height=0;e.images=[];e.currentIndex=0;e.dom=a.createElement("div",{style:"position:relative;text-align:left;width:100%;height:100%;display:block;overflow:hidden;"});if(c){for(var d in c){e[d]=c[d]}}};b.prototype={initImage:function(d){var c=this;c.image=new Fei.fImage({src:d||"",container:c,onload:function(){c.stretchOptimally().centerImage().doChange()}});if(!d){c.image.setSrc(c.images[c.currentIndex])}a.removeChildren(c.dom);c.dom.appendChild(c.image.dom);c.image.init();c.initEvents();return c},render:function(d){var c=this;(d||document.body).appendChild(c.dom);c.width=c.dom.offsetWidth;c.height=c.dom.offsetHeight;c.coord=a.getCoord(c.dom);c.initImage();return c},setImages:function(c){var d=this;d.images=c;d.currentIndex=0;d.image.setSrc(d.images[d.currentIndex]);return d},initEvents:function(){var d=this,c=document.getElementById(d.image.domId);a.addEvent(c,"mousedown",d.mousedown,d);a.addEvent(c,"mousemove",d.mousemove,d);a.addEvent(c,"mouseup",d.mouseup,d);a.addEvent(c,"mouseout",d.mouseup,d);if("onmousewheel" in document.documentElement){a.addEvent(c,"mousewheel",d.mousewheel,d)}else{a.addEvent(c,"DOMMouseScroll",d.mousewheel,d)}return d},mousewheel:function(j){var i=this,j=j||window.event,d=j.wheelDelta,e=1,h=i.coord,c=j.clientX,k=j.clientY,g=i.image;if(d===undefined){d=0-(j.detail||0)}if(d>0){e=1.1}else{e=0.9}var f={top:k-h.top-g.translates.y,left:c-h.left-g.translates.x};g.scale(e,f.left/g.width,f.top/g.height).doChange();if(j.stopPropagation){j.stopPropagation()}if(j.preventDefault){j.preventDefault()}window.event?window.event.returnValue=false:j.preventDefault()},mousedown:function(e){var d=this,e=e||window.event,c=d.image;d.lastTranslateX=c.translates.x;d.lastTranslateY=c.translates.y;d.moveStartX=e.x||e.clientX;d.moveStartY=e.y||e.clientY;d.isMoveing=true;c.isMoveing=true;c.translateSpeed=0;if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}window.event?window.event.returnValue=false:e.preventDefault()},mousemove:function(f){var e=this,f=f||window.event,d;if(e.isMoveing){d=e.image;var c=(f.x||f.clientX)-e.moveStartX+e.lastTranslateX;var g=(f.y||f.clientY)-e.moveStartY+e.lastTranslateY;e.image.transition(c,g).doChange()}if(f.stopPropagation){f.stopPropagation()}if(f.preventDefault){f.preventDefault()}window.event?window.event.returnValue=false:f.preventDefault()},mouseup:function(d){var c=this;c.isMoveing=false;c.image.isMoveing=false;c.image.translateSpeed=c.image.orgTranslateSpeed},doChange:function(){var d=this,c=d.image;c.doChange();return d},stretchH:function(){var e=this,d=e.image,c=d.getOrgSize();d.setAdSize(e.width,c.h*e.width/c.w);return e},stretchV:function(){var e=this,d=e.image,c=d.getOrgSize();d.setAdSize(c.w*e.height/c.h,e.height);return e},originalOptimally:function(){var d=this,c=d.image;c.width=c.orgWidth;c.height=c.orgHeight;return d},stretchOptimally:function(){var e=this,d=e.image,c=d.getOrgSize(),f=d.getAdSize();if(c.h<=e.height&&c.w<=e.width){e.originalOptimally()}else{if(f.w*e.height/f.h>e.width){e.stretchH()}else{e.stretchV()}}return e},centerImage:function(){var h=this,e=h.image,g=e.rotation%360,d=e.getAdSize(),f=0;if(g===90||g===270||g===-90||g===-270){f=(d.h-d.w)/2}var c=(h.width-d.w)/2-f;var i=(h.height-d.h)/2+f;e.transition(c,i);return h},rotate:function(e){var d=this,c=d.image;c.rotate(e);return d},scale:function(e){var d=this,c=d.image;c.scale(e);return d},switchTo:function(d){var e=this,c=e.image;if(a.isUseVml()){e.initImage(e.images[d])}else{c.setSrc(e.images[d])}return e},nextImage:function(){var e=this,d=navigator.userAgent.toLowerCase(),c=e.image;e.currentIndex++;if(e.currentIndex>e.images.length-1){e.currentIndex=0}e.switchTo(e.currentIndex);return e},upImage:function(){var d=this,c=d.image;d.currentIndex--;if(d.currentIndex<0){d.currentIndex=d.images.length-1}d.switchTo(d.currentIndex)}}})();