/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(e){var g=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks){for(var h=g.length;h;){e.event.fixHooks[g[--h]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var a=g.length;a;){this.addEventListener(g[--a],f,false)}}else{this.onmousewheel=f}},teardown:function(){if(this.removeEventListener){for(var a=g.length;a;){this.removeEventListener(g[--a],f,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}});function f(m){var c=m||window.event,d=[].slice.call(arguments,1),l=0,a=true,n=0,b=0;m=e.event.fix(c);m.type="mousewheel";if(c.wheelDelta){l=c.wheelDelta/120}if(c.detail){l=-c.detail/3}b=l;if(c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS){b=0;n=-1*l}if(c.wheelDeltaY!==undefined){b=c.wheelDeltaY/120}if(c.wheelDeltaX!==undefined){n=-1*c.wheelDeltaX/120}d.unshift(m,l,n,b);return(e.event.dispatch||e.event.handle).apply(this,d)}})(jQuery);(function(b){b.fn.addAutocomplete=function(){return this.each(function(){var a=b(this).data("keyboard");if(!a){return}a.autocomplete_new_version=(function(d){d[0]=parseInt(d[0],10);return(d[0]>1)||(d[0]===1&&parseInt(d[1],10)>=9)})(b.ui.version.split("."));a.autocomplete_init=function(h,g,f){if(a.options.alwaysOpen&&a.isVisible()){a.autocomplete_setup()}a.$el.bind("visible.keyboard",function(){a.autocomplete_setup()}).bind("change.keyboard",function(){if(a.hasAutocomplete&&a.isVisible()){a.$el.val(a.$preview.val()).trigger("keydown.autocomplete")}}).bind("hidden.keyboard",function(c){a.$el.autocomplete("close")}).bind("autocompleteopen",function(c,d){if(a.hasAutocomplete){a.$autocomplete.menu.element.position({of:a.$keyboard,my:"right top",at:"left top",collision:"flip"})}}).bind("autocompleteselect",function(c,d){var e=d.item.value;if(a.hasAutocomplete&&e!==""){a.$preview.val(e).focus();a.lastCaret={start:e.length,end:e.length}}})};a.autocomplete_setup=function(){a.$autocomplete=a.$el.data("autocomplete")||a.$el.data("uiAutocomplete");a.hasAutocomplete=(typeof(a.$autocomplete)==="undefined")?false:(a.$autocomplete.options.disabled)?false:true;if(a.hasAutocomplete){a.$preview.bind("keydown",function(d){return a.autocomplete_input(d)});a.$allKeys.bind("mouseup mousedown mouseleave touchstart touchend touchcancel",function(d){a.autocomplete_input(d)})}};a.autocomplete_input=function(g){var h,f=b.ui.keyCode;switch(g.keyCode){case f.PAGE_UP:a.$autocomplete._move("previousPage",g);g.preventDefault();break;case f.PAGE_DOWN:a.$autocomplete._move("nextPage",g);g.preventDefault();break;case f.UP:a.$autocomplete._move("previous",g);g.preventDefault();break;case f.DOWN:a.$autocomplete._move("next",g);g.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:h=a.$autocomplete.menu.element.find("#ui-active-menuitem,.ui-state-focus").text()||"";if(h!==""){a.$preview.val(h)}if(a.autocomplete_new_version){a.$autocomplete.menu.select(g)}break;default:clearTimeout(a.$autocomplete.searching);a.$autocomplete.searching=setTimeout(function(){if(a.$autocomplete.term!==a.$autocomplete.element.val()){a.$autocomplete.selectedItem=null;a.$autocomplete.search(null,g)}},a.$autocomplete.options.delay);break}};a.origEscClose=a.escClose;a.escClose=function(d){if(a.hasAutocomplete&&(d.target.id==="ui-active-menuitem"||b(d.target).closest("ul").hasClass("ui-autocomplete"))){return}a.origEscClose(d)};a.autocomplete_init()})}})(jQuery);(function(b){b.fn.addMobile=function(a){var e,f={container:{theme:"a"},buttonMarkup:{theme:"a",shadow:"true",corners:"true"},buttonHover:{theme:"c"},buttonAction:{theme:"b"},buttonActive:{theme:"e"}};return this.each(function(){var c=b(this).data("keyboard");if(!c||typeof(b.fn.textinput)==="undefined"){return}c.mobile_options=e=b.extend({},f,a);c.mobile_init=function(){b(".ui-keyboard-input").textinput();if(c.options.alwaysOpen&&c.isVisible){c.mobile_setup()}c.$el.on("beforeVisible.keyboard",function(){c.$keyboard.css("visibility","hidden")}).on("visible.keyboard",function(){c.mobile_setup();c.$keyboard.css("visibility","visible");c.$preview.focus()})};c.mobile_setup=function(){var d,h=b.extend({},e.buttonMarkup,e.buttonAction);c.$keyboard.addClass("ui-bar ui-bar-"+e.container.theme).removeClass("ui-widget ui-widget-content").find("button:not(."+c.options.css.buttonAction+")").addClass(c.modButton(e.buttonMarkup)).end().find("."+c.options.css.buttonAction).addClass(c.modButton(h)).end().find("button").removeClass("ui-corner-all ui-state-default").hover(function(){b(this).addClass("ui-btn-hover-"+e.buttonHover.theme)},function(){b(this).removeClass("ui-btn-hover-"+e.buttonHover.theme)});c.options.css.buttonAction="ui-btn-down-"+e.buttonActive.theme;if(c.msie&&c.$preview[0]!==c.el){c.$preview.hide();c.$keyboard.css("width","");c.width=c.$keyboard.outerWidth();c.$keyboard.width(c.width+parseInt(c.$preview.css("fontSize"),10));c.$preview.width(c.width);c.$preview.show()}d=c.options.position;d.of=d.of||c.$el.data("keyboardPosition")||c.$el;d.collision=(c.options.usePreview)?d.collision||"fit fit":"flip flip";c.$keyboard.position(d)};c.modButton=function(d){return"ui-btn ui-btn-up-"+d.theme+" ui-btn-"+d.theme+(d.shadow=="true"?" ui-shadow":"")+(d.corners=="true"?" ui-btn-corner-all":"")};c.mobile_init()})}})(jQuery);(function(b){b.keyboard=b.keyboard||{};b.keyboard.navigationKeys={toggle:112,enter:13,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,caretrt:45,caretlt:46};b.fn.addNavigation=function(a){return this.each(function(){var g,j,i=b(this).data("keyboard"),h={position:[0,0],toggleMode:false,focusClass:"hasFocus"};if(!i){return}i.navigation_options=g=b.extend({},h,a);i.navigation_keys=j=b.extend({},b.keyboard.navigationKeys);i.saveNav=[i.options.tabNavigation,i.options.enterNavigation];i.allNavKeys=b.map(j,function(d,c){return d});i.navigation_init=function(){i.$keyboard.toggleClass(g.focusClass,g.toggleMode).find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+g.position[0]+","+g.position[1]+'"]').addClass("ui-state-hover");i.$preview.unbind("keydown.keyboardNav").bind("keydown.keyboardNav",function(c){return i.checkKeys(c.which)})};i.checkKeys=function(c,d){if(typeof(c)==="undefined"){return}var e=i.navigation_keys;if(c===e.toggle||d){g.toggleMode=(d)?false:!g.toggleMode;i.options.tabNavigation=(g.toggleMode)?false:i.saveNav[0];i.options.enterNavigation=(g.toggleMode)?false:i.saveNav[1]}i.$keyboard.toggleClass(g.focusClass,g.toggleMode);if(g.toggleMode&&c===e.enter){i.$keyboard.find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+g.position[0]+","+g.position[1]+'"]').trigger("repeater.keyboard");return false}if(g.toggleMode&&b.inArray(c,i.allNavKeys)>=0){i.navigateKeys(c);return false}};i.navigateKeys=function(f,e,l){l=l||g.position[1];e=e||g.position[0];var c=i.$keyboard.find(".ui-keyboard-keyset:visible"),k=c.find(".ui-keyboard-button-endrow").length-1,p=c.find('.ui-keyboard-button[data-pos^="'+e+',"]').length-1,d=i.lastCaret,t=i.$preview.val().length,s=i.navigation_keys;switch(f){case s.pageup:e=0;break;case s.pagedown:e=k;break;case s.end:l=p;break;case s.home:l=0;break;case s.left:l+=(l>0)?-1:0;break;case s.up:e+=(e>0)?-1:0;break;case s.right:l+=1;break;case s.down:e+=(e+1>k)?0:1;break;case s.caretRt:d.start++;break;case s.caretLt:d.start--;break}if(f===s.caretRt||f===s.caretLt){d.start=d.start<0?0:d.start>t?t:d.start;d.end=d.start;i.lastCaret=d;i.$preview.focus().caret(d.start,d.start)}p=c.find('.ui-keyboard-button[data-pos^="'+e+',"]').length-1;if(l>p){l=p}c.find(".ui-state-hover").removeClass("ui-state-hover");c.find('.ui-keyboard-button[data-pos="'+e+","+l+'"]').addClass("ui-state-hover");g.position=[e,l]};if(i.options.alwaysOpen&&i.isVisible){i.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover");i.navigation_init()}i.$el.bind("visible.keyboard",function(c){i.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover");i.navigation_init()}).bind("inactive.keyboard hidden.keyboard",function(c){i.checkKeys(c.which,true)}).bind("navigate navigateTo",function(d,c,e){c=isNaN(c)?c.toLowerCase():c;if(i.navigation_keys.hasOwnProperty(c)){i.checkKeys(i.navigation_keys[c])}else{i.navigateKeys(null,c,e)}})})}})(jQuery);(function(b){b.keyboard=b.keyboard||{};b.fn.addScramble=function(a){var d={targetKeys:/[a-z\d]/i,byRow:true,randomizeOnce:true};return this.each(function(){var c,f=b(this).data("keyboard");if(!f){return}c=f.scramble_options=b.extend({},d,a);f.scramble_setup=function(s){var v,r,e,B,u,w,t,x,A,z,y;v=s.find(".ui-keyboard-keyset");if(s.length){for(r=0;r<v.length;r++){e=v.eq(r);t=0;y=[];A=[];x=[];z=[];e.children("button, span, br").each(function(){if(this.tagName==="BR"){if(c.byRow){y.push(this);A.push(false);z[t]=y;x[t]=A;y=[];A=[];t++}else{z[t]=this;x[t]=false;t++}}else{w=b(this).attr("data-value")||"";w=w.length===1&&c.targetKeys.test(w)?w:false;if(c.byRow){y.push(this);A.push(w)}else{z[t]=this;x[t]=w;t++}}});e.find(".ui-keyboard-button-endrow").remove();if(!c.byRow){y=f.shuffle(z,x);for(B=0;B<y.length;B++){e.append(y[B])}}else{for(u=0;u<z.length;u++){y=f.shuffle(z[u],x[u]);for(B=0;B<y.length;B++){e.append(y[B])}}}}return s}};f.shuffle=function(k,l){var m,n,e=k.length;while(e>0){n=Math.floor(Math.random()*e);if(l[e-1]===false){e--}if(l[e-1]!==false&&l[n]!==false){e--;m=k[e];k[e]=k[n];k[n]=m}}return k};f.options.create=function(){var e=f.options.layout;b.keyboard.builtLayouts[e]={mappedKeys:{},acceptedKeys:[],$keyboard:null};if(typeof b.keyboard.builtLayouts[f.orig_layout]==="undefined"){f.layout=f.options.layout=f.orig_layout;f.buildKeyboard();f.layout=f.options.layout=e}b.keyboard.builtLayouts[e]=b.extend({},b.keyboard.builtLayouts[f.orig_layout]);if(c.randomizeOnce){b.keyboard.builtLayouts[e].$keyboard=f.scramble_setup(b.keyboard.builtLayouts[f.orig_layout].$keyboard.clone())}f.$keyboard=b.keyboard.builtLayouts[e].$keyboard;if(!c.randomizeOnce){f.$el.bind("beforeVisible.keyboard",function(i,j){j.$keyboard=j.scramble_setup(j.$keyboard)})}};f.orig_layout=f.options.layout;f.options.layout="scrambled"+Math.round(Math.random()*10000)})}})(jQuery);(function(b){b.fn.addTyping=function(a){var d={showTyping:true,delay:250};return this.each(function(){var c=b(this).data("keyboard");if(!c){return}c.typing_options=b.extend({},d,a);c.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","\n":"Enter","\r":"Enter","\t":"tab"};c.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space"};c.typing_event=false;c.typing_setup=function(){var f=(c.$preview)?c.$preview:c.$el;f.bind("keyup.keyboard",function(e){if(e.which>=37&&e.which<=40){return}if(e.which===16){c.shiftActive=false}if(e.which===18){c.altActive=false}if(e.which===16||e.which===18){c.showKeySet();setTimeout(function(){c.$preview.focus()},200);return}}).bind("keydown.keyboard",function(e){e.temp=false;if(e.which===16){e.temp=(c.shiftActive)?false:true;c.shiftActive=true}if(e.which===18){e.temp=(c.altActive)?false:true;c.altActive=true}if(e.temp){c.showKeySet();c.$preview.focus()}c.typing_event=true;if(e.which===8||e.which===9){c.typeIn("",c.typing_options.delay||250,function(){c.typing_event=false},e)}}).bind("keypress.keyboard",function(e){if(c.typing_event&&!c.options.lockInput){c.typeIn("",c.typing_options.delay||250,function(){c.typing_event=false},e)}})};c.typeIn=function(n,x,z,k){if(!c.isVisible()){c.typing_options.init=false;clearTimeout(c.typing_timer);return}var o=c.typing_options,m,E,F,D,A,e,y,C,B=b.keyboard.builtLayouts[c.layout].mappedKeys;if(c.typing_options.init!==true){o.init=true;o.text=n;o.len=n.length;o.delay=x||300;o.current=0;o.callback=z}n=o.text.substring(o.current,++o.current);e=c.$keyboard.find(".ui-keyboard-keyset");D=(c.typing_keymap.hasOwnProperty(n))?c.typing_keymap[n]:n;m='.ui-keyboard-button[data-value="'+D+'"]';if(c.typing_event&&k){if(c.typing_xref.hasOwnProperty(k.keyCode||k.which)){m=".ui-keyboard-"+c.typing_xref[k.keyCode||k.which]}else{E=String.fromCharCode(k.charCode||k.which);m=(B.hasOwnProperty(E))?'.ui-keyboard-button[data-value="'+B[E]+'"]':".ui-keyboard-"+(k.charCode||k.which)}}A=e.filter(":visible").find(m);if(A.length){c.typing_simulateKey(A,n)}else{if(c.typing_event){A=e.find(m)}else{F=(c.typing_keymap.hasOwnProperty(n))?c.typing_keymap[n]:n.charCodeAt(0);if(F==="bksp"){n=F}A=e.find(".ui-keyboard-"+F)}C=A.closest(".ui-keyboard-keyset");if(C.attr("name")){y=C.attr("name");c.shiftActive=/shift/.test(y);c.altActive=/alt/.test(y);c.metaActive=c.lastKeyset[2]=(y).match(/meta\d+/)||false;c.showKeySet({name:c.metaActive});c.typing_simulateKey(A,n)}else{if(!c.typing_event){c.insertText(n);c.checkCombos()}}}if(o.current<o.len){if(!c.isVisible()){return}setTimeout(function(){c.typeIn()},o.delay)}else{o.init=false;if(b.isFunction(o.callback)){setTimeout(function(){o.callback(c)},o.delay)}return}};c.typing_simulateKey=function(i,j){var e=i.length;if(e){i.filter(":visible").trigger("mouseenter.keyboard")}c.typing_timer=setTimeout(function(){if(e){setTimeout(function(){i.trigger("mouseleave.keyboard")},c.typing_options.delay/3)}if(!c.isVisible()){return}if(!c.typing_event){c.insertText(j);c.checkCombos()}},c.typing_options.delay/3)};if(c.typing_options.showTyping){if(c.options.alwaysOpen&&c.isVisible()){c.typing_setup()}c.$el.bind("visible.keyboard",function(){c.typing_setup()})}})}})(jQuery);