{"version":3,"sources":["../../zhongbao3/zb2focus2.js"],"names":["outputW","$","width","oneTextW","setInputVal","task","str","info","alg_answer","val","html","strL","console","log","length","pt","style","paddingLeft","keyboardEvent","htmlCurosr","H5board","initialize","options","maxLength","_cursorIndex","_$input","_$fakeInput","_$cursor","on","touchstart","e","_onFocus","bind","$target","target","hasClass","_onBlur","blur","setInputPT","v","_showCursor","left","offset","x","originalEvent","touches","clientX","pageX","cursorIndex","parseInt","substr","focus","show","find","hide","put","num","preStr","toString","endStr","replace","_$clear","_onChange","del","h5board","strArr","split","off","preventDefault","css","document","scrollTop","animate","touchend","delTimer3","setTimeout","clearInterval","delTimer1","delTimer2","event","stopPropagation","jsloadDone"],"mappings":"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","file":"zb2focus2.js","sourcesContent":["/**\n * Created by raferxu on 17/7/6.\n */\nvar outputW = $('#output').width();\nvar oneTextW;\nfunction setInputVal(task) {\n  //发送图片获取识别字符串，并放入input中\n  var str = task.info.alg_answer || '';\n  $('.showInfo').val(str);\n  $('#textLength').html(str);\n  var strL = $('#textLength').width();\n  console.log('#output元素宽度：'+outputW);\n  console.log('答案文字宽度：'+strL);\n  console.log('单个文字宽度：'+strL/str.length);\n  oneTextW = strL/str.length || 18;\n  if(!strL){\n    console.log('获取不到答案文字总长度');\n    strL=oneTextW;\n  }\n  var pt = (outputW-strL)/2 + 'px';\n  console.log('paddingLeft: '+pt);\n  $('.input-wrap')[0].style.paddingLeft = pt;\n  keyboardEvent(str);\n}\nvar htmlCurosr = '<span class=\"input-cursor\">|</span>';\nvar H5board = (function () {\n  return {\n    initialize: function(options) {\n\n      this.maxLength = options.maxLength || 18;\n      this._cursorIndex = 0;\n      this._$input = $('.input-input');\n      // this._$input2 = $('#input-input');\n      this._$fakeInput = $('.input-fake');\n      this._$cursor = $('.input-cursor');\n\n      this._$input.on(touchstart, function(e) {\n        this._onFocus(e);\n      }.bind(this));\n      $('body').on(touchstart, function(e) {\n        // click other div, hide keyboard\n        var $target = $(e.target);\n        if ($target.hasClass('input-input') || $target.hasClass('input-fake') ||\n          $target.hasClass('input-clear') || $target.hasClass('input-clear-icon')) {\n          this._onFocus(e);\n        } else {\n          this._onBlur();\n        }\n      }.bind(this));\n\n      this.blur();\n      return this;\n    },\n    setInputPT: function (v) {\n      $('#textLength').html(v);\n      var pt = (outputW-$('#textLength').width())/2 + 'px';\n      $('.input-wrap')[0].style.paddingLeft = pt;\n    },\n    _showCursor: function(e) {\n      var left = this._$input.offset().left;\n      var x = e.originalEvent.touches[0].x || e.originalEvent.touches[0].clientX || e.originalEvent.touches[0].pageX;\n      console.log(e);\n      var val = this._$input.val();\n      var cursorIndex = (x - left > 0) ? parseInt((x - left) / oneTextW) : 0;\n      cursorIndex = cursorIndex >= val.length ? val.length : cursorIndex;\n      console.log('_showCursor cursorIndex: '+cursorIndex);\n      this._cursorIndex = cursorIndex;\n      this._$fakeInput.html(val.substr(0, cursorIndex) + htmlCurosr);\n    },\n    focus: function() {\n      this._$fakeInput.show();\n      $('body').find('input:not(.input-input)').blur();\n    },\n    _onFocus: function(e) {\n      this.focus();\n      this._showCursor(e);\n      // this.onFocus && this.onFocus();\n    },\n    _onBlur: function() {\n      this.blur();\n      // this.onBlur & this.onBlur();\n    },\n    blur: function() {\n      // this._$clear && this._$clear.hide();\n      this._$fakeInput.hide();\n    },\n    put: function(val) {\n      var num = this._$input.val();\n      if (num.length < this.maxLength) {\n        var preStr = num.substr(0, this._cursorIndex) + val.toString();\n        var endStr = num.substr(this._cursorIndex);\n        num = num.replace(/\\s*/g, '');\n        num = preStr + endStr;\n        this._$input.val(num);\n        this._$fakeInput.html(preStr + htmlCurosr);\n        this._$fakeInput.show();\n        this._$clear && this._$clear.show();\n        this._cursorIndex++;\n        this._onChange && this._onChange(num);\n      }\n      this.setInputPT(num);\n    },\n    del: function() {\n      if (this._cursorIndex > 0) {\n        var num = this._$input.val();\n        var preStr = num.substr(0, this._cursorIndex - 1);\n        var endStr = num.substr(this._cursorIndex);\n        num = num.replace(/\\s*/g, \"\");\n        num = preStr + endStr;\n        this._$input.val(num);\n        this._$fakeInput.html(preStr + htmlCurosr);\n        this._$fakeInput.show();\n        this._$clear && this._$clear.show();\n        this._cursorIndex--;\n        this._onChange && this._onChange(num);\n      }\n      this.setInputPT(num);\n    },\n  }\n})();\n\nvar h5board = H5board.initialize({\n  target: $('.input-bar')\n});\n\nfunction keyboardEvent(str) {\n  var strArr = [];\n  strArr = str.split('');\n  $('#answerInput').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    $('#keyboardWrap').css('top',$(document).scrollTop()+'px').show();\n    // alert($(document).scrollTop());\n    $('.keyboard').animate({'bottom': 0},function () {\n      $(document).on(touchend, function(e) {\n        var delTimer3 = setTimeout(function () {\n          clearInterval(delTimer1);\n          clearInterval(delTimer2);\n          clearInterval(delTimer3);\n        },0);\n      });\n    });\n  });\n  $('#sureTotalBtn').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    $('.keyboard').animate({'bottom': '-4rem'},function () {\n      $(document).off(touchend);\n      $('#keyboardWrap').hide();\n    });\n  });\n  var delTimer1 = null, delTimer2 = null;\n  $('#delTxt').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    h5board.del();\n  });\n  $('#keyboardM').off(touchstart).on(touchstart, '.zi', function(e) {\n    e.preventDefault();\n    h5board.put($(this).html());\n  });\n  $('#keyboardWrap').off(touchstart).on(touchstart, function (e) {\n    console.log(e.target);\n    $(this).hide();\n  });\n  $('#keyboard').off(touchstart).on(touchstart, function (event) {\n    event.stopPropagation();\n  });\n\n  $(document).on(touchend, function(e) {\n    var delTimer3 = setTimeout(function () {\n      clearInterval(delTimer1);\n      clearInterval(delTimer2);\n      clearInterval(delTimer3);\n    },0);\n  });\n\n}\n\njsloadDone = true;\nconsole.log('jsloadDone: '+jsloadDone);"]}