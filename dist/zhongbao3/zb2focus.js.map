{"version":3,"sources":["../../zhongbao3/zb2focus.js"],"names":["setInputVal","task","str","info","alg_answer","$","val","keyboardEvent","htmlCurosr","H5board","initialize","options","maxLength","_cursorIndex","_$input","_$fakeInput","_$cursor","on","touchstart","e","_onFocus","bind","$target","target","hasClass","_onBlur","blur","_showCursor","left","offset","x","originalEvent","touches","clientX","pageX","console","log","cursorIndex","parseInt","length","html","substr","focus","show","find","hide","put","num","preStr","toString","endStr","replace","_$clear","_onChange","del","h5board","strArr","split","off","preventDefault","css","document","scrollTop","animate","touchend","delTimer3","setTimeout","clearInterval","delTimer1","delTimer2","event","stopPropagation","jsloadDone"],"mappings":"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","file":"zb2focus.js","sourcesContent":["/**\n * Created by raferxu on 17/7/6.\n */\nfunction setInputVal(task) {\n  //发送图片获取识别字符串，并放入input中\n  var str = task.info.alg_answer || '';\n  $('.showInfo').val(str);\n  keyboardEvent(str);\n}\nvar htmlCurosr = '<span class=\"input-cursor\">|</span>';\nvar H5board = (function () {\n  return {\n    initialize: function(options) {\n\n      this.maxLength = options.maxLength || 18;\n      this._cursorIndex = 0;\n      this._$input = $('.input-input');\n      this._$fakeInput = $('.input-fake');\n      this._$cursor = $('.input-cursor');\n\n      this._$input.on(touchstart, function(e) {\n        this._onFocus(e);\n      }.bind(this));\n      $('body').on(touchstart, function(e) {\n        // click other div, hide keyboard\n        var $target = $(e.target);\n        if ($target.hasClass('input-input') || $target.hasClass('input-fake') ||\n          $target.hasClass('input-clear') || $target.hasClass('input-clear-icon')) {\n          this._onFocus(e);\n        } else {\n          this._onBlur();\n        }\n      }.bind(this));\n\n      this.blur();\n      return this;\n    },\n    _showCursor: function(e) {\n      var left = this._$input.offset().left;\n      var x = e.originalEvent.touches[0].x || e.originalEvent.touches[0].clientX || e.originalEvent.touches[0].pageX;\n      console.log(e);\n      var val = this._$input.val();\n      var cursorIndex = (x - left > 0) ? parseInt((x - left) / 18) : 0;\n      cursorIndex = cursorIndex >= val.length ? val.length : cursorIndex;\n      console.log('_showCursor cursorIndex: '+cursorIndex);\n      this._cursorIndex = cursorIndex;\n      this._$fakeInput.html(val.substr(0, cursorIndex) + htmlCurosr);\n    },\n    focus: function() {\n      this._$fakeInput.show();\n      $('body').find('input:not(.input-input)').blur();\n    },\n    _onFocus: function(e) {\n      this.focus();\n      this._showCursor(e);\n      // this.onFocus && this.onFocus();\n    },\n    _onBlur: function() {\n      this.blur();\n      // this.onBlur & this.onBlur();\n    },\n    blur: function() {\n      // this._$clear && this._$clear.hide();\n      this._$fakeInput.hide();\n    },\n    put: function(val) {\n      var num = this._$input.val();\n      if (num.length < this.maxLength) {\n        var preStr = num.substr(0, this._cursorIndex) + val.toString();\n        var endStr = num.substr(this._cursorIndex);\n        num = num.replace(/\\s*/g, '');\n        num = preStr + endStr;\n        this._$input.val(num);\n        this._$fakeInput.html(preStr + htmlCurosr);\n        this._$fakeInput.show();\n        this._$clear && this._$clear.show();\n        this._cursorIndex++;\n        this._onChange && this._onChange(num);\n      }\n    },\n    del: function() {\n      if (this._cursorIndex > 0) {\n        var num = this._$input.val();\n        var preStr = num.substr(0, this._cursorIndex - 1);\n        var endStr = num.substr(this._cursorIndex);\n        num = num.replace(/\\s*/g, \"\");\n        num = preStr + endStr;\n        this._$input.val(num);\n        this._$fakeInput.html(preStr + htmlCurosr);\n        this._$fakeInput.show();\n        this._$clear && this._$clear.show();\n        this._cursorIndex--;\n        this._onChange && this._onChange(num);\n      }\n    },\n  }\n})();\n\nvar h5board = H5board.initialize({\n  target: $('.input-bar')\n});\n\nfunction keyboardEvent(str) {\n  var strArr = [];\n  strArr = str.split('');\n  $('#answerInput').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    $('#keyboardWrap').css('top',$(document).scrollTop()+'px').show();\n    // alert($(document).scrollTop());\n    $('.keyboard').animate({'bottom': 0},function () {\n      $(document).on(touchend, function(e) {\n        var delTimer3 = setTimeout(function () {\n          clearInterval(delTimer1);\n          clearInterval(delTimer2);\n          clearInterval(delTimer3);\n        },0);\n      });\n    });\n  });\n  $('#sureTotalBtn').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    $('.keyboard').animate({'bottom': '-4rem'},function () {\n      $(document).off(touchend);\n      $('#keyboardWrap').hide();\n    });\n  });\n  var delTimer1 = null, delTimer2 = null;\n  $('#delTxt').off(touchstart).on(touchstart, function(e) {\n    e.preventDefault();\n    // if(strArr.length>0){\n    //   strArr.pop();\n    //   $('.showInfo').val(strArr.join(''));\n    //   delTimer1 = setInterval(function () {\n    //     console.log('delTimer1');\n    //     strArr.pop();\n    //     $('.showInfo').val(strArr.join(''));\n    //     if(strArr.length>0){\n    //       delTimer2 = setInterval(function () {\n    //         clearInterval(delTimer1);\n    //         strArr.pop();\n    //         $('.showInfo').val(strArr.join(''));\n    //         console.log('delTimer2');\n    //       },200);\n    //     }\n    //   },500);\n    // }\n    h5board.del();\n  });\n  $('#keyboardM').off(touchstart).on(touchstart, '.zi', function(e) {\n    e.preventDefault();\n    h5board.put($(this).html());\n    // strArr.push($(this).html());\n    // $('.showInfo').val(strArr.join(''));\n  });\n  $('#keyboardWrap').off(touchstart).on(touchstart, function (e) {\n    console.log(e.target);\n    $(this).hide();\n  });\n  $('#keyboard').off(touchstart).on(touchstart, function (event) {\n    event.stopPropagation();\n  });\n\n  $(document).on(touchend, function(e) {\n    var delTimer3 = setTimeout(function () {\n      clearInterval(delTimer1);\n      clearInterval(delTimer2);\n      clearInterval(delTimer3);\n    },0);\n  });\n\n}\n\njsloadDone = true;\nconsole.log('jsloadDone: '+jsloadDone);"]}