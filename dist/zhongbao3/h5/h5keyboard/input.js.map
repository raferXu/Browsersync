{"version":3,"sources":["../../../../zhongbao3/h5/h5keyboard/input.js"],"names":["Input","htmlInput","htmlCurosr","initialize","options","$root","root","$target","target","html","maxLength","_cursorIndex","_$input","$","_$fakeInput","_$clear","_$cursor","on","e","_onFocus","bind","_onClear","hasClass","_onBlur","blur","put","val","num","length","preStr","substr","toString","endStr","replace","show","_onChange","del","_showCursor","left","offset","x","clientX","pageX","cursorIndex","parseInt","clear","focus","find","hide","value","onChange","console","log","onFocus","onBlur","height"],"mappings":"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","file":"input.js","sourcesContent":["var Input = (function() {\n  var htmlInput = '\\\n    <section class=\"input-container\" onselectstart=\"return false;\">\\\n      <div class=\"input-bar\">\\\n          <input style=\"background:#dcdcdc;border:1px solid #dcdcdc;text-align:left\" id=\"answerInput\" type=\"text\" class=\"input-input showInfo tc bsb\" readonly=\"readonly\">\\\n          <div class=\"input-fake\"><span class=\"input-cursor\">|</span></div>\\\n      </div>\\\n    </section>';\n  var htmlCurosr = '<span class=\"input-cursor\">|</span>';\n  return {\n    initialize: function(options) {\n      this.$root = options.root;\n      this.$target = options.target;\n      this.$target.html(htmlInput);\n\n      this.maxLength = options.maxLength || 18;\n      this._cursorIndex = 0;\n      this._$input = $('.input-input');\n      this._$fakeInput = $('.input-fake');\n      this._$clear = $('.input-clear');\n      this._$cursor = $('.input-cursor');\n\n      this._$input.on('click', function(e) {\n        this._onFocus(e);\n      }.bind(this));\n      this._$clear.on('click', function(e) {\n        this._onClear();\n      }.bind(this));\n      this.$root.on('click', function(e) {\n        // click other div, hide keyboard\n        var $target = $(e.target);\n        if ($target.hasClass('input-input') || $target.hasClass('input-fake') ||\n          $target.hasClass('input-clear') || $target.hasClass('input-clear-icon')) {\n          this._onFocus(e);  //目标是以上元素时获取焦点\n        } else {\n          this._onBlur();\n        }\n      }.bind(this));\n\n      this.blur();\n      return this;\n    },\n    put: function(val) {  //插入字符\n      var num = this._$input.val();  //获取input值\n      if (num.length < this.maxLength) {  //长度在限制范围内\n        var preStr = num.substr(0, this._cursorIndex) + val.toString();  //截取光标索引之前的字符和传入参数进行拼接\n        var endStr = num.substr(this._cursorIndex);  //截取光标之后的字符串\n        num = num.replace(/\\s*/g, '');  //去除空格\n        num = preStr + endStr;  //拼接加入参数后的字符串\n        this._$input.val(num);  //重设输入框的值\n        this._$fakeInput.html(preStr + htmlCurosr);  //将光标索引之前的字符和传入参数和\"|\"进行拼接，放入伪造input\n        this._$fakeInput.show();  //显示伪造input\n        this._$clear && this._$clear.show();  //执行_$clear.show函数(存在的话)\n        this._cursorIndex++;  //光标索引加1\n        this._onChange && this._onChange(num);  //执行_onChange(存在的话)\n      }\n    },\n    del: function() {\n      if (this._cursorIndex > 0) {  //光标索引大于0\n        var num = this._$input.val();  //获取输入框的值\n        var preStr = num.substr(0, this._cursorIndex - 1);  //截取索引位置前一个字符之前的所有字符\n        var endStr = num.substr(this._cursorIndex);  //截取索引之后的所有字符\n        num = num.replace(/\\s*/g, \"\");  //去除空格或换行\n        num = preStr + endStr;  //重新拼接除了索引前一个字符之外的其他字符\n        this._$input.val(num);  //重置输入框的值\n        this._$fakeInput.html(preStr + htmlCurosr);  //重置伪造input的值\n        this._$fakeInput.show();  //显示伪造input\n        this._$clear && this._$clear.show();  //执行_$clear.show(存在的话)\n        this._cursorIndex--;  //光标索引减1\n        this._onChange && this._onChange(num);  //执行_onChange(存在的话)\n      }\n    },\n    _showCursor: function(e) {  //确定伪造input值\n      var left = this._$input.offset().left;  //输入框离文档左边距离\n      var x = e.x || e.clientX || e.pageX;  //点击位置离文档左边距离\n      var val = this._$input.val();  //\n      var cursorIndex = (x - left > 0) ? parseInt((x - left) / 36) : 0;  //每个字宽度设为8，计算点击的大概位置索引\n      cursorIndex = cursorIndex >= val.length ? val.length : cursorIndex;  //确定最后的自定义焦点位置\n      this._cursorIndex = cursorIndex;  //\n      this._$fakeInput.html(val.substr(0, cursorIndex) + htmlCurosr);  //截取点击位置之前的字符串与自定义焦点'|'拼接组成伪造字符串\n    },\n    clear: function() {  //清空input,将伪造input的值设为\"|\",重置光标索引为0\n      this._$input.val('');\n      this._$fakeInput.html(htmlCurosr);\n      this._cursorIndex = 0;\n    },\n    focus: function() {  //执行_$clear.show(存在的话),隐藏伪造input,所有其他input失去焦点\n      this._$clear && this._$clear.show();\n      this._$fakeInput.show();\n      // blur other input\n      this.$root.find('input:not(.input-input)').blur();\n    },\n    blur: function() {  //执行_$clear.hide(存在的话),隐藏伪造input\n      this._$clear && this._$clear.hide();\n      this._$fakeInput.hide();\n    },\n    value: function() {  //获取输入框的值\n      return this._$input.val();\n    },\n    _onChange: function(num) {  //执行onChange(存在的话)\n      this.onChange && this.onChange(num);\n    },\n    _onClear: function() {  //清除input内容并执行_onChange(存在的话)\n      console.log('clear');\n      this.clear();\n      this._onChange && this._onChange('');\n    },\n    _onFocus: function(e) {  //获取焦点,显示光标,并执行focus(存在的话)\n      this.focus();\n      this._showCursor(e);\n      this.onFocus && this.onFocus();\n    },\n    _onBlur: function() {  //失去焦点并执行onBlur函数(存在的话)\n      this.blur();\n      this.onBlur & this.onBlur();\n    },\n    offset: function() {  //输入框相对文档位置\n      return this._$input.offset();\n    },\n    height: function() {  //输入框高度\n      return this._$input.height();\n    }\n  }\n}());"]}